"use strict";Array.prototype.move=function(a,b){if(b>=this.length)for(var c=b-this.length;c--+1;)this.push(void 0);return this.splice(b,0,this.splice(a,1)[0]),this},angular.module("openCompareEditor",["ui.grid","ui.grid.edit","ui.grid.selection","ui.grid.cellNav","ui.grid.resizeColumns","ui.grid.moveColumns","ui.grid.autoResize","ui.bootstrap","ui.slider","ui.grid.pinning","chart.js","pascalprecht.translate","ab-base64","naif.base64"]),angular.module("openCompareEditor").directive("openCompareEditor",function(){function a(a){}function b(a){}return b.$inject=["$scope"],{restrict:"E",scope:{pcmContainer:"=pcmContainer",pcmId:"=pcmId",enableEdit:"=edit"},link:a,controller:b,templateUrl:"/templates/pcmEditor.html"}}),angular.module("openCompareEditor").directive("openCompareToolbar",function(){return{templateUrl:"/templates/toolbar.html"}}),angular.module("openCompareEditor").directive("superColWidthUpdate",["$timeout","$rootScope",function(a,b){return{restrict:"A",link:function(c,d){var e=(c.col.colDef.superCol,jQuery(d),function(){var b=c.col.colDef.superCol,e=jQuery(d);a(function(){if(b){var a=jQuery('.ui-grid-header-cell[col-name="'+b+'"]'),c=a.outerWidth(),d=e.outerWidth();c=(1===c?0:c)+d,a.css({"min-width":c+"px","max-width":c+"px","text-align":"center"})}},0)}),f=function(){var b=c.col.colDef.superCol;jQuery(d);a(function(){if(b){var a=jQuery('.ui-grid-header-cell[col-name="'+b+'"]');a.css({"min-width":"0px","max-width":"0px"}),e()}},0)};b.$on("reloadFeatureGroup",f)}}}]),angular.module("openCompareEditor").controller("ToolbarCtrl",["$rootScope","$scope","$modal",function(a,b,c){b.saved=!1,b.isInDatabase=!1,b.validating=!1,b.edit=!1,b.configurator=!1,b.lineView=!0,b.isTitleSet=!1,b.launchFromCreator=!1,b.save=function(){a.$broadcast("save")},b.remove=function(){a.$broadcast("remove")},b.cancel=function(){a.$broadcast("cancel")},b.setConfigurator=function(c){b.configurator=c,a.$broadcast("setConfiguratorMode",c)},b.openCreateFeatureGroupModal=function(){b.$modalInstance=c.open({templateUrl:"/templates/modalCreateFeatureGroup.html",scope:b,controller:"ToolbarCtrl"})},b.addFeatureGroup=function(c,d){a.$broadcast("addFeatureGroup",{featureGroup:c,features:d}),b.$modalInstance.close()},b.cancelModal=function(){b.$modalInstance.close()},b.$on("setLineView",function(a,c){b.lineView=c}),b.$on("launchFromCreator",function(a,c){b.launchFromCreator=!0}),b["export"]=function(b){a.$broadcast("export",b)},b.validate=function(){a.$broadcast("validate")},b.setEdit=function(c,d){b.edit=c,a.$broadcast("setGridEdit",[c,d])},b.increaseHeight=function(b){a.$broadcast("increaseHeight",b)},b.$on("modified",function(a,c){b.saved=!1}),b.$on("validating",function(a,c){b.validating=!b.validating}),b.$on("completelyValidated",function(a,c){b.validated=!0}),b.$on("saved",function(a,c){b.saved=!0,b.isInDatabase=!0,c&&(b.id=c)}),b.$on("savedFromCreator",function(a,c){b.saved=!0,b.isInDatabase=!0,b.id=c}),b.$on("setToolbarEdit",function(a,c){b.edit=c}),b.$on("launchCreation",function(a,c){b.edit=!0,b.isTitleSet=!0,b.pcmName=c.title}),b.$on("setPcmName",function(a,c){b.isTitleSet=c.length>0,b.pcmName=c})}]),angular.module("openCompareEditor").controller("EditorCtrl",["$controller","$rootScope","$scope","$http","$timeout","uiGridConstants","$compile","$modal","expandeditor","$location","pcmApi","editorUtil",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(a){var b=k.factory.createPCM();b.name=c.pcm.name;var d={},e={},f=0;return a.forEach(function(a){var g=k.factory.createProduct();g.name=a.name,b.addProducts(g);var h=c.gridOptions.superColDefs,i=c.gridOptions.columnDefs;if(h.length>0){for(var j=0;j<h.length;j++){var m=l.convertStringToPCMFormat(h[j].name),n=h[j].name;if(!e.hasOwnProperty(n))if("emptyFeatureGroup"!=n){var o=k.factory.createFeatureGroup();o.name=m,e[m]=o;for(var p=c.getFeaturesWithThisFeatureGroup(n,i),q=0;q<p.length;q++)if(!d.hasOwnProperty(l.convertStringToPCMFormat(p[q]))&&" "!==p[q]&&"Product"!==p[q]){var r=k.factory.createFeature();r.name=l.convertStringToPCMFormat(p[q]),o.addSubFeatures(r),d[l.convertStringToPCMFormat(p[q])]=r}b.addFeatures(o)}else for(var p=c.getFeaturesWithThisFeatureGroup(h[j].name,i),s=0;s<p.length;s++)if(!d.hasOwnProperty(p[s])&&" "!==p[s]&&"Product"!==p[s]){e[l.convertStringToPCMFormat(h[j].name)]="empty";var r=k.factory.createFeature();r.name=l.convertStringToPCMFormat(p[s]),d[l.convertStringToPCMFormat(p[s])]=r,b.addFeatures(r)}}c.gridOptions.columnDefs.forEach(function(b){var e=l.convertStringToPCMFormat(b.name),h=b.name;if(a.hasOwnProperty(e)&&" "!==e&&"Product"!==e){var i=d[e],j=k.factory.createCell();j.feature=i,j.content=a[h],j.rawContent=c.pcmDataRaw[f][h],g.addCells(j)}})}else c.gridOptions.columnDefs.forEach(function(e){var h=l.convertStringToPCMFormat(e.name),i=e.name;if(a.hasOwnProperty(h)&&" "!==i&&"Product"!==i){if(!d.hasOwnProperty(h)){var j=k.factory.createFeature();j.name=h,b.addFeatures(j),d[h]=j}var j=d[h],m=k.factory.createCell();m.feature=j,m.content=a[i],m.rawContent=c.pcmDataRaw[f][i],g.addCells(m)}});f++}),k.encodePCM(b),b}function n(a,b){var d={};d.featurePositions=[],d.productPositions=[];var e=0;return a.forEach(function(a){var b={};b.product=a.name,b.position=e,d.productPositions.push(b),e++}),e=0,b.forEach(function(a){var b={};b.feature=l.convertStringToPCMFormat(a.name),b.position=e,d.featurePositions.push(b),e++}),d.source=c.source,d.license=c.license,d}$.material&&$.material.init();var o={$scope:c,$location:j};a("GridCtrl",o),a("UndoRedoCtrl",o),a("CommandsCtrl",o),a("FiltersCtrl",o),a("TypesCtrl",o),a("ShareCtrl",o),a("FeatureGroupCtrl",o),c.export_content=null,c.oldFeatureName="",c.featureName="",c.loaded=!1,c.lineView=!0,c.setEdit=function(a,d){c.gridOptions.columnDefs=[],c.gridOptions.rowHeight=35,c.edit=a,d&&e(function(){c.initializeEditor(c.pcm,c.metadata,!1,!0)},100),b.$broadcast("setToolbarEdit",a)},c.setEdit(!1,!1),c.$watch("pcmContainer",function(a){"undefined"!=typeof a&&(c.pcm=k.loadPCMModelFromString(a),k.decodePCM(c.pcm),c.metadata=a.metadata,c.initializeEditor(c.pcm,c.metadata,!1,!0))}),c.$watch("pcmId",function(a){"undefined"!=typeof a&&(c.id=a,c.loading=!0,c.setEdit(!1,!1),c.updateShareLinks(),d.get("/api/get/"+c.id).success(function(a){c.pcm=k.loadPCMModelFromString(JSON.stringify(a.pcm)),k.decodePCM(c.pcm),c.metadata=a.metadata,c.initializeEditor(c.pcm,c.metadata,!1,!0),b.$broadcast("saved",c.id)})["finally"](function(){c.loading=!1}))}),c.$on("initializeFromExternalSource",function(a,b){c.pcm=k.loadPCMModelFromString(JSON.stringify(b.pcm)),k.decodePCM(c.pcm),c.metadata=b.metadata,c.initializeEditor(c.pcm,c.metadata,!1,!0)}),c.$on("setConfiguratorMode",function(a,d){c.configurator=d,b.$broadcast("initConfigurator",{features:c.gridOptions.columnDefs,pcmData:c.pcmData})}),c.$on("setLineView",function(a,b){c.lineView=b}),c.$on("increaseHeight",function(a,b){switch(b){case 1:c.gridOptions.rowHeight=35;break;case 2:c.gridOptions.rowHeight=60;break;case 4:c.gridOptions.rowHeight=120;break;case 8:c.gridOptions.rowHeight=240}c.initializeEditor(c.pcm,c.metadata,!1,!0),c.setGridHeight()}),c.$on("goToCell",function(a,b){c.scrollToFocus(b.row,b.col)}),c.setGridHeight=function(){if(c.pcmData)if(c.pcmData.length*c.gridOptions.rowHeight+100>2*$(window).height()/3&&!c.enableEdit)c.height=2*$(window).height()/3;else if(c.pcmData.length*c.gridOptions.rowHeight+100>$(window).height()&&c.enableEdit){var a=20;("true"==l.GetUrlValue("enableExport")||"true"==l.GetUrlValue("enableShare"))&&(a+=40),"true"==l.GetUrlValue("enableTitle")&&(a+=c.pcm.name.length>30?120:60),c.enableEdit&&(a+=c.edit?80:40),c.height=$(window).height()-a}else c.height=c.pcmData.length*c.gridOptions.rowHeight+130},c.scrollToFocus=function(a,b){c.gridApi.cellNav.scrollToFocus(c.pcmData[a],c.gridOptions.columnDefs[b])},c.save=function(){var a=m(c.pcmData);c.metadata=n(c.pcmData,c.gridOptions.columnDefs);var e=JSON.parse(k.serializePCM(a)),f={};f.metadata=c.metadata,f.pcm=e,"undefined"==typeof id?d.post("/api/create",f).success(function(a){id=a,c.updateShareLinks(),console.log("model created with id="+id),b.$broadcast("savedFromCreator",id)}):d.post("/api/save/"+id,f).success(function(a){console.log("model saved"),b.$broadcast("saved")})},c.remove=function(){"undefined"!=typeof id&&d.get("/api/remove/"+id).success(function(a){window.location.href="/",console.log("model removed")})},c.cancel=function(){window.location="/view/"+id},c.$watch("pcm.name",function(){c.edit&&b.$broadcast("setPcmName",c.pcm.name)}),c.$on("launchCreation",function(a,d){b.$broadcast("launchFromCreator"),c.pcm=k.factory.createPCM(),c.setEdit(!0,!1),c.initializeEditor(c.pcm,c.metadata,!1,!0),c.pcm.name=d.title;for(var e=0;e<d.rows;e++){var f="Product "+(e+1);c.addProduct(f)}for(var g=0;g<d.columns;g++){var h="Feature "+(g+1);c.addFeature(h)}}),c.$on("save",function(a,b){c.save()}),c.$on("remove",function(a,b){c.remove()}),c.$on("cancel",function(a,b){c.cancel()}),c.$on("validate",function(a,b){c.validate()}),c.$on("setGridEdit",function(a,b){c.setEdit(b[0],b[1])}),c.$on("import",function(a,b){c.pcm=k.loadPCMModelFromString(JSON.stringify(b.pcm)),k.decodePCM(c.pcm),c.metadata=b.metadata,c.initializeEditor(c.pcm,c.metadata)}),c.$on("export",function(a,b){var d=m(c.pcmData);c.metadata=n(c.pcmData,c.gridOptions.columnDefs);var e=JSON.parse(k.serializePCM(d));c.pcmObject={},c.pcmObject.metadata=c.metadata,c.pcmObject.pcm=e;var f=b.toUpperCase().charAt(0)+b.substring(1);h.open({templateUrl:"/templates/modal"+f+"Export.html",controller:f+"ExportController",scope:c,size:"lg"})})}]),angular.module("openCompareEditor").controller("UndoRedoCtrl",["$rootScope","$scope","$http","$timeout","uiGridConstants","sortFeaturesService","editorUtil",function(a,b,c,d,e,f,g){function h(a,d,e){for(var f=0;f<b.pcmData.length;f++)if(b.pcmData[f].$$hashKey==a){c.post("/api/extract-content",{type:"wikipedia",rawContent:e,responseType:"text/plain",transformResponse:function(a,b){return a}}).success(function(a){b.pcmData[f][d]=a}),b.pcmDataRaw[f][d]=e,console.log(e);break}}function i(a,d,e){for(var f=0;f<b.pcmData.length;f++)if(b.pcmData[f].$$hashKey==a){c.post("/api/extract-content",{type:"wikipedia",rawContent:e,responseType:"text/plain",transformResponse:function(a,b){return a}}).success(function(a){b.pcmData[f][d]=a}),b.pcmDataRaw[f][d]=e;break}}function j(a,c,e){b.pcmData.splice(e,0,a),b.pcmDataRaw.splice(e,0,c),d(function(){b.scrollToFocus(e,1)},100),b.setGridHeight()}function k(a){for(var c=!1,d=0;d<b.pcmData.length&&!c;d++)b.pcmData[d].$$hashKey==a&&(b.pcmData.splice(b.pcmData.indexOf(b.pcmData[d]),1),b.pcmDataRaw.splice(b.pcmData.indexOf(b.pcmData[d]),1),c=!0);b.setGridHeight()}function l(a){b.pcmData.push(a),b.pcmDataRaw.push(a),d(function(){b.scrollToFocus(b.pcmData.length-1,1)},100),b.setGridHeight()}function m(a,c,d,e){b.gridOptions.columnDefs.splice(e,0,a),b.pcmData.forEach(function(e){for(var f=0,g=!1;f<c.length&&!g;)e.$$hashKey==c[f][0]&&(e[a.name]=c[f][1],b.pcmDataRaw[f][a.name]=d[f][1],g=!0),f++})}function n(c,d){var e=b.newColumnDef(c,d);b.gridOptions.columnDefs.push(e);var c=g.checkIfNameExists(c,b.gridOptions.columnDefs);b.pcmData.forEach(function(a){a[c]=""}),b.pcmDataRaw.forEach(function(a){a[c]=""}),b.validation[c]=[],a.$broadcast("modified")}function o(a,c,d){for(var e=g.convertStringToEditorFormat(c),f=g.convertStringToEditorFormat(a),h=!1,i="",j=0;!h&&j<b.gridOptions.columnDefs.length;j++)if(b.gridOptions.columnDefs[j].name===e){i=b.gridOptions.columnDefs[j].type,h=!0;var k=0;b.pcmData.forEach(function(a){a[f]=a[e],b.pcmDataRaw[k][f]=b.pcmDataRaw[k][e],c!=f&&(delete a[e],delete b.pcmDataRaw[k][e]),k++});var l=b.newColumnDef(a,i);b.gridOptions.columnDefs.splice(d,1,l)}b.validation[e]=[],f!=f&&delete b.validation[e]}function p(a,c){for(var f=!1,g=0;g<b.gridOptions.columnDefs.length&&!f;g++)if(b.gridOptions.columnDefs[g].name==a){f=!0,b.gridOptions.columnDefs.splice(g,1);var h=b.newColumnDef(a,c);d(function(){b.gridOptions.columnDefs.splice(g-1,0,h)},100)}b.gridApi.core.notifyDataChange(e.dataChange.COLUMN)}function q(a,c){b.pcmDataRaw.forEach(function(b){delete b[a]}),b.pcmData.forEach(function(b){delete b[a]}),b.gridOptions.columnDefs.splice(c,1)}function r(a){for(var c=0;c<b.gridOptions.columnDefs.length;c++)b.gridOptions.columnDefs[c].superCol==a&&(b.gridOptions.columnDefs[c].superCol="emptyFeatureGroup");var d=0;for(var e in b.gridOptions.superColDefs){if(b.gridOptions.superColDefs[d]&&b.gridOptions.superColDefs[d].name==a){b.gridOptions.superColDefs.splice(d,1);break}d++}}function s(a,c){for(var d=0;d<b.gridOptions.columnDefs.length;d++)for(var e=0;e<c.length;e++)if(c[e]==b.gridOptions.columnDefs[d].name){b.gridOptions.columnDefs[d].superCol=a;break}var g={name:a,displayName:a};b.gridOptions.superColDefs.push(g),b.gridOptions.superColDefs=f.sortFeatureGroupByName(b.gridOptions.superColDefs),b.deleteUnusedFeatureGroups(),b.gridOptions.columnDefs=f.sortByFeatureGroup(b.gridOptions.columnDefs)}function t(a,c){for(var d=0;d<b.gridOptions.columnDefs.length;d++)if(b.gridOptions.columnDefs[d].superCol==c){b.gridOptions.columnDefs[d].superCol=a;break}var e=0;for(var g in b.gridOptions.superColDefs){if(b.gridOptions.superColDefs[e]&&b.gridOptions.superColDefs[e].name==c){b.gridOptions.superColDefs[e].name=a,b.gridOptions.superColDefs[e].displayName=a;break}e++}b.gridOptions.superColDefs=f.sortFeatureGroupByName(b.gridOptions.superColDefs)}b.commands=[],b.commandsIndex=0,b.canUndo=!1,b.canRedo=!1,b.undo=function(){if(b.commandsIndex>0){b.commandsIndex--,b.canRedo=!0;var c=b.commands[b.commandsIndex],d=c[1];switch(c[0]){case"move":b.gridOptions.columnDefs.move(d[1],d[0]);break;case"edit":h(d[0],[d[1]],d[2]);break;case"removeProduct":j(d[1],d[2],d[3]);break;case"addProduct":k(d.$$hashKey);break;case"removeFeature":m(d[0],d[1],d[2],d[3]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs);break;case"renameFeature":o(d[0],d[1],d[2]);break;case"changeType":p(d[0],d[1]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs);break;case"addFeature":q(d[0],d[2]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs);break;case"addFeatureGroup":r(d[0]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs);break;case"deleteFeatureGroup":s(d[0],d[1]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs);break;case"renameFeatureGroup":t(d[0],d[1]);break;case"assignFeatureGroup":undoAssignFeatureGroup(d[0],d[1]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs)}b.commandsIndex<=0&&(b.canUndo=!1)}a.$broadcast("modified")},b.redo=function(){if(b.commandsIndex<b.commands.length){var c=b.commands[b.commandsIndex],d=c[1];switch(c[0]){case"move":b.gridOptions.columnDefs.move(d[0],d[1]);break;case"edit":i(d[0],d[1],d[3]);break;case"removeProduct":k(d[0]);break;case"addProduct":l(d);break;case"removeFeature":q(d[0].name,d[3]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs);break;case"renameFeature":o(d[1],d[0],d[2]);break;case"changeType":p(d[0],d[2]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs);break;case"addFeature":n(d[0],d[1]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs);break;case"addFeatureGroup":s(d[0],d[1]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs);break;case"deleteFeatureGroup":r(d[0]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs);break;case"renameFeatureGroup":t(d[1],d[0]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs);break;case"assignFeatureGroup":redoAssignFeatureGroup(d[0],d[1]),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs)}b.commandsIndex++,b.canUndo=!0,b.commandsIndex>=b.commands.length&&(b.canRedo=!1)}a.$broadcast("modified")}}]),angular.module("openCompareEditor").controller("CommandsCtrl",["$rootScope","$scope","$http","$timeout","uiGridConstants","featureGroupService","sortFeaturesService","editorUtil","$modal",function(a,b,c,d,e,f,g,h,i){b.newCommand=function(a,c){var d=[];d.push(a),d.push(c),b.commands[b.commandsIndex]=d,b.commandsIndex++,b.canUndo=!0},b.addFeature=function(c){c||(c=h.checkIfNameExists(b.featureName,b.gridOptions.columnDefs));var d=h.convertStringToEditorFormat(c);b.pcmData.forEach(function(a){a[d]=""}),b.pcmDataRaw.forEach(function(a){a[d]=""});var e=b.newColumnDef(c,"emptyFeatureName",b.featureType);b.gridOptions.columnDefs.push(e),b.validation[d]=[];var f=[c,b.featureType,b.gridOptions.columnDefs.length-1];b.newCommand("addFeature",f),a.$broadcast("modified"),a.$broadcast("reloadFeatureGroup")},a.$on("addFeatureGroup",function(c,d){for(var e=d.featureGroup,f=d.features,h=!1,i=0;i<b.gridOptions.superColDefs.length;i++){var j=b.gridOptions.superColDefs[i];j.hasOwnProperty("name")&&"emptyFeatureGroup"==j.name&&(h=!0)}if(!h){var k={name:"emptyFeatureGroup",displayName:" "};b.gridOptions.superColDefs.push(k),b.gridOptions.columnDefs.forEach(function(a){a.superCol="emptyFeatureGroup"})}var l={name:e,displayName:e};b.gridOptions.superColDefs.splice(0,0,l),b.gridOptions.superColDefs=g.sortFeatureGroupByName(b.gridOptions.superColDefs);var m=[];for(var n in f)1==f[n]&&m.push(n);b.gridOptions.columnDefs.forEach(function(a){-1!=m.indexOf(a.name)&&(a.superCol=e)}),b.deleteUnusedFeatureGroups(),b.gridOptions.columnDefs=g.sortByFeatureGroup(b.gridOptions.columnDefs);var o=[e,m];b.newCommand("addFeatureGroup",o),a.$broadcast("modified"),b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs)}),b.renameFeature=function(){var c=h.convertStringToEditorFormat(b.oldFeatureName),d=h.checkIfNameExists(b.featureName,b.gridOptions.columnDefs),e=h.convertStringToEditorFormat(d),f=0;b.gridOptions.columnDefs.forEach(function(a){if(a.name===c){c===b.featureName&&(d=b.oldFeatureName);var g=0;b.pcmData.forEach(function(a){a[e]=a[c],b.pcmDataRaw[g][e]=b.pcmDataRaw[g][c],b.featureName!=b.oldFeatureName&&(delete a[c],delete b.pcmDataRaw[g][c]),g++});var h=b.newColumnDef(d,a.superCol,a.type);b.gridOptions.columnDefs.splice(f,1,h);var i=[b.oldFeatureName,d,f];b.newCommand("renameFeature",i)}f++}),b.validation[d]=[],b.featureName!=b.oldFeatureName&&delete b.validation[c],b.featureName="",b.oldFeatureName="",a.$broadcast("modified")},a.$on("renameFeatureGroup",function(c,d){for(var e=d.oldFeatureGroup,f=d.newFeatureGroup,g=h.convertStringToEditorFormat(e),i=(h.checkIfNameExists(f,b.gridOptions.columnDefs),h.convertStringToEditorFormat(f)),j=0;j<b.gridOptions.superColDefs.length;j++)if(b.gridOptions.superColDefs[j].name==g){b.gridOptions.superColDefs[j].name=i,b.gridOptions.superColDefs[j].displayName=i;break}for(var j=0;j<b.gridOptions.columnDefs.length;j++)b.gridOptions.columnDefs[j].superCol===g&&(b.gridOptions.columnDefs[j].superCol=i);var k=[g,i];b.newCommand("renameFeatureGroup",k),b.featureName="",a.$broadcast("modified"),a.$broadcast("reloadFeatureGroup")}),b.deleteFeatureGroup=function(c){for(var d=0;d<b.gridOptions.superColDefs.length;d++)if(b.gridOptions.superColDefs[d].name==c){b.gridOptions.superColDefs.splice(d,1);break}for(var e=[],d=0;d<b.gridOptions.columnDefs.length;d++)b.gridOptions.columnDefs[d].superCol===c&&(e.push(b.gridOptions.columnDefs[d].name),b.gridOptions.columnDefs[d].superCol="emptyFeatureGroup");var f=[c,e];b.newCommand("deleteFeatureGroup",f),b.gridOptions.columnDefs=g.sortByFeatureGroup(b.gridOptions.columnDefs,b.gridOptions.superColDefs),a.$broadcast("modified"),a.$broadcast("reloadFeatureGroup")},a.$on("assignFeatureGroup",function(c,d){var e=[];for(var f in d.features)1==d.features[f]&&e.push(f);b.gridOptions.columnDefs.forEach(function(a){-1!=e.indexOf(a.name)?a.superCol=d.featureGroup:a.superCol==d.featureGroup&&(a.superCol="emptyFeatureGroup")}),b.deleteUnusedFeatureGroups(),b.gridOptions.columnDefs=g.sortByFeatureGroup(b.gridOptions.columnDefs),a.$broadcast("modified"),a.$broadcast("reloadFeatureGroup")}),b.deleteFeature=function(c){delete b.validation[c];var d=0;b.gridOptions.columnDefs.forEach(function(a){if(a.name===c){var e=[],f=[],g=[],h=0;b.pcmData.forEach(function(d){var e=[d.$$hashKey,d[c]],i=[d.$$hashKey,b.pcmDataRaw[h][c]];f.push(e),g.push(i),delete b.pcmData[h][a.name],delete b.pcmDataRaw[h][a.name],h++}),e.push(b.gridOptions.columnDefs[d]),e.push(f),e.push(g),e.push(d),b.newCommand("removeFeature",e),b.gridOptions.columnDefs.splice(d,1)}d++}),console.log("Feature is deleted"),a.$broadcast("modified"),a.$broadcast("reloadFeatureGroup")},b.changeType=function(){for(var a=b.featureName,c=h.convertStringToEditorFormat(a),f=!1,g=0;g<b.gridOptions.columnDefs.length&&!f;g++)if(b.gridOptions.columnDefs[g].name==c){var i=b.gridOptions.columnDefs[g].type;f=!0,b.gridOptions.columnDefs.splice(g,1),b.gridOptions.columnDefs[g].superCol||(b.gridOptions.columnDefs[g].superCol="emptyFeatureGroup");var j=b.newColumnDef(a,b.gridOptions.columnDefs[g].superCol,b.featureType);d(function(){b.gridOptions.columnDefs.splice(g-1,0,j)},100);var k=[a,i,b.featureType];b.newCommand("changeType",k)}b.gridApi.core.notifyDataChange(e.dataChange.COLUMN)},b.addProduct=function(c){var f={},g=[];c?f.name=c:f.name="",b.gridOptions.columnDefs.forEach(function(a){" "!=a.name&&"Product"!=a.name&&(f[a.name]="",f.name="",g[a.name]="")}),b.pcmDataRaw.push(g),b.pcmData.push(f),b.gridApi.core.notifyDataChange(e.dataChange.COLUMN),d(function(){b.scrollToFocus(b.pcmData.length-1,1)},100),console.log("Product added"),a.$broadcast("modified");var h=b.pcmData[b.pcmData.length-1];b.newCommand("addProduct",h),b.setGridHeight()},b.removeProduct=function(c){var d=b.pcmData.indexOf(c.entity),e=b.pcmDataRaw[d];b.pcmData.splice(d,1),b.pcmDataRaw.splice(d,1),a.$broadcast("modified");var f=[c.entity.$$hashKey,c.entity,e,d];b.newCommand("removeProduct",f),b.setGridHeight()}}]),angular.module("openCompareEditor").controller("GridCtrl",["$rootScope","$scope","$window","$http","$timeout","uiGridConstants","$location","pcmApi","expandeditor","typeService","editorOptions","editorUtil","sortFeaturesService","chartService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(a){if(a.files&&a.files[0]){var b=new FileReader;b.onload=function(a){console.log(a.target.result)},b.readAsDataURL(a.files[0])}}function p(a,c,d,e){var g=[],h=0,i=!1;if(d.map(function(a){var c=a.name;a.name||(c=" ");var d="emptyFeatureGroup";a.parentGroup&&(d=a.parentGroup.name,i=!0);var e=b.newColumnDef(c,d,j.getType(c,b.pcmData));g.push(e),h++}),i&&e){b.gridOptions.superColDefs=[];var k={name:"emptyFeatureGroup",displayName:" "};b.gridOptions.superColDefs.push(k),a.features.array.forEach(function(a){var c=!1;if(d.map(function(b){a.name==b.name&&(c=!0)}),!c){var e=a.name,f={name:e,displayName:e};b.gridOptions.superColDefs.splice(0,0,f)}})}c&&(b.pcmData=l.sortProducts(b.pcmData,c.productPositions),b.pcmDataRaw=l.sortRawProducts(b.pcmDataRaw,b.pcmData),g=l.sortFeatures(g,c.featurePositions));var n={name:" ",cellTemplate:"/templates/toolCellTemplate.html",enableCellEdit:!1,enableFiltering:!1,enableColumnResizing:!1,pinnedLeft:!0,enableSorting:!1,enableHiding:!1,enableColumnMenu:!1,allowCellFocus:!1,enableColumnMoving:!1};switch(b.edit){case!0:n.width=30;break;case!1:n.width=1}var o={name:"Product",field:"name",cellClass:function(a,b,c,d,e){return"productCell"},enableSorting:!0,enableHiding:!1,enableColumnMoving:!1,enableCellEdit:b.edit,enableCellEditOnFocus:b.edit,pinnedLeft:!0,allowCellFocus:!0,minWidth:150,width:150,menuItems:[{title:"Unhide everything",icon:"fa fa-eye",action:function(a){b.gridOptions.columnDefs.forEach(function(a){a.visible=!0}),b.gridApi.core.notifyDataChange(f.dataChange.COLUMN)}}]};o.filter=[],o.filter.term="",o.filter.placeholder="Find",o.filterHeaderTemplate="<div class='ui-grid-filter-container'>   <input type='text' class='form-control floating-label' ng-change='grid.appScope.applyProductFilter()' ng-model='grid.appScope.productFilter' placeholder='Find'</div>",o.footerCellTemplate="<div class='ui-grid-cell-contents'><span>{{grid.appScope.gridApi.core.getVisibleRows($scope.gridApi.grid).length}} / {{grid.appScope.pcmData.length}}</span></div>",g.splice(0,0,n),g.splice(1,0,o),b.gridOptions.superColDefs.length>0?b.gridOptions.columnDefs=m.sortByFeatureGroup(g,b.gridOptions.superColDefs):b.gridOptions.columnDefs=g}function q(){"false"==l.GetUrlValue("enableExport")&&(b.enableExport=!1),"false"==l.GetUrlValue("enableTitle")&&(b.enableTitle=!1),"false"==l.GetUrlValue("enableShare")&&(b.enableShare=!1),"true"==l.GetUrlValue("deleteAfterLoaded")&&"undefined"!=typeof id&&d.get("/api/remove/"+id),b.edit||a.$broadcast("initConfigurator",{features:b.gridOptions.columnDefs,pcmData:b.pcmData})}function r(a,c,e){return d.post("/api/extract-content",{type:"wikipedia",rawContent:a,responseType:"text/plain",transformResponse:function(a,b){return a}}).success(function(a){b.pcmData[c][e]=a,b.gridApi.core.notifyDataChange(f.dataChange.COLUMN)}),"Loading value..."}b.height=300,b.minWidth=130,b.enableExport=k.enableExport,b.enableTitle=!0,b.enableShare=k.enableShare,b.file=[],b.FeaturGroupIndex=1,b.gridOptions={headerTemplate:"/templates/featureGroupHeader.html",superColDefs:[],columnDefs:[],data:"pcmData",enableRowSelection:!1,showColumnFooter:!0,enableRowHeaderSelection:!1,flatEntityAccess:!0,enableColumnResizing:!0,enableFiltering:!0,enableCellSelection:!1,enableCellEdit:!1,headerRowHeight:60,rowHeight:35},b.columnMovedFunctions=[],b.beginCellEditFunctions=[],b.afterCellEditFunctions=[],b.onNavigateFunctions=[],b.loading=!1;var s,t;$("#img").change(function(){o(this)}),b.putRawDataInCell=function(a,c){b.pcmData[b.pcmData.indexOf(a)][c.name]=b.pcmDataRaw[b.pcmData.indexOf(a)][c.name]},b.setVisualRepresentation=function(c,d,e,f,g){if(e&&g!=e){if(a.$broadcast("modified"),b.pcmData[b.pcmData.indexOf(c)][d.name]=r(e,b.pcmData.indexOf(c),d.name),"Product"!=d.name)var h=[c.$$hashKey,d.name,g,e];else var h=[c.$$hashKey,"name",g,e];b.newCommand("edit",h)}else b.pcmData[b.pcmData.indexOf(c)][d.name]=f;b.pcmDataRaw[b.pcmData.indexOf(c)][d.name]=e},b.moveColumnData=function(c,d,e){b.gridOptions.columnDefs.move(d,e);var f=[d,e];b.newCommand("move",f),a.$broadcast("modified")},b.columnMovedFunctions.push(b.moveColumnData),b.beginCellEditFunctions.push(b.putRawDataInCell),b.afterCellEditFunctions.push(b.setVisualRepresentation),b.gridOptions.onRegisterApi=function(a){b.gridApi=a,a.colMovable.on.columnPositionChanged(b,function(a,c,d){for(var e=0;e<b.columnMovedFunctions.length;e++)b.columnMovedFunctions[e]()}),a.edit.on.beginCellEdit(b,function(a,c){for(var d=0;d<b.beginCellEditFunctions.length;d++)b.beginCellEditFunctions[d](a,c,s,t)}),a.edit.on.afterCellEdit(b,function(a,c,d,e){for(var f=0;f<b.pcmData.length;f++)if(b.pcmData[f].$$hashKey==a.$$hashKey)var g=b.pcmDataRaw[f][c.name];for(var f=0;f<b.afterCellEditFunctions.length;f++)b.afterCellEditFunctions[f](a,c,d,e,g)}),a.cellNav.on.navigate(b,function(a,c){for(var d=0;d<b.onNavigateFunctions.length;d++)b.onNavigateFunctions[d](a,c);for(var e=i.expandNavigateFunctions().navigateFunctions,d=0;d<e.length;d++)e[d](a,c)}),a.colResizable.on.columnSizeChanged(b,function(a,c){b.resizeFeatureGroup(b.gridOptions.columnDefs,a,c)})},b.setGridHeight=function(){b.pcmData&&(28*b.pcmData.length+90>2*$(window).height()/3&&!b.enableEdit?b.height=2*$(window).height()/3:28*b.pcmData.length+90>$(window).height()?b.height=$(window).height():b.height=28*b.pcmData.length+90)},b.newColumnDef=function(c,d,e){if(e||(e="string"),d)var g=d;else g="empltyFeatureGroup";var h=l.convertStringToEditorFormat(c),i={name:h,displayName:c,width:"*",enableSorting:!0,enableHiding:!1,enableFiltering:!0,enableColumnResizing:!0,enableColumnMoving:!1,enablePinning:!1,enableCellEdit:b.edit,enableCellEditOnFocus:b.edit,allowCellFocus:!0,superCol:g,filter:{term:""},minWidth:b.minWidth,cellTemplate:"/templates/cellTemplate.html",menuItems:[{title:"Hide",icon:"fa fa-eye-slash",action:function(c){b.gridOptions.columnDefs.forEach(function(a){a.name===h&&(i.visible=!1,b.gridApi.core.notifyDataChange(f.dataChange.COLUMN))}),a.$broadcast("reloadFeatureGroup")}},{title:"Rename Feature",shown:function(){return b.edit},icon:"fa fa-pencil",action:function(a){$("#modalRenameFeature").modal("show"),b.oldFeatureName=c,b.featureName=c}},{title:"Change Type",icon:"fa fa-exchange",action:function(a){$("#modalChangeType").modal("show"),b.oldFeatureName=c,b.featureName=c,b.gridOptions.columnDefs.forEach(function(a){a.name===h&&(b.featureType=a.type)})}},{title:"Delete Feature",shown:function(){return b.edit},icon:"fa fa-trash-o",action:function(a){b.deleteFeature(h)}},{title:"Unhide everything",icon:"fa fa-eye",action:function(c){b.gridOptions.columnDefs.forEach(function(a){a.visible=!0}),b.gridApi.core.notifyDataChange(f.dataChange.COLUMN),a.$broadcast("reloadFeatureGroup")}}],cellClass:function(a,c,d){var f=b.pcmDataRaw[b.pcmData.indexOf(c.entity)];return b.validating&&b.validation[d.name]&&!b.validation[d.name][b.pcmData.indexOf(c.entity)]?"warningCell":f?l.getCellClass(f[d.name],e):void 0},cellTooltip:function(a,c){var d=b.pcmDataRaw[b.pcmData.indexOf(a.entity)],e=b.pcmData[b.pcmData.indexOf(a.entity)];return b.validating&&b.validation[c.name]&&!b.validation[c.name][b.pcmData.indexOf(a.entity)]?"This value doesn't seem to match the feature type.":d&&l.getCellTooltip(d[c.name])?l.getCellTooltip(d[c.name]):e?e[c.name]:void 0}};switch(e){case"string":i.type="string",i.filterHeaderTemplate="<div class='ui-grid-filter-container' ng-show='!grid.appScope.configurator'>   <button class='btn btn-primary mdi-action-search btn-flat btn-sm' style='padding: 4px 6px;' ng-click='grid.appScope.showFilter(col)'>   </button>   <button ng-show='grid.appScope.isFilterOn(col)' class='btn btn-default btn-sm fa fa-close' style='padding:5px' ng-click='grid.appScope.removeFilter(col)'>   </button></div>",i.filter.noTerm=!0,i.filter.condition=function(a,c){return b.filterStringColumns(c,h)},i.footerCellTemplate="<div class='ui-grid-cell-contents'><button class='btn btn-primary fa fa-pie-chart btn-sm' ng-class='{\"btn btn-primary btn-sm \" : grid.appScope.isInStringPieChart(col) == 1, \"btn btn-flat btn-primary btn-sm\": grid.appScope.isInStringPieChart(col) != 1}' ng-click='grid.appScope.stringPieChart(col)' style='margin: 0 1px 0 1px;padding:2px 5px 2px 5px;'></button><button class='btn btn-primary fa fa-connectdevelop btn-sm' ng-class='{\"btn btn-primary btn-sm \" : grid.appScope.isInStringRadarChart(col) == 1, \"btn btn-flat btn-primary btn-sm\": grid.appScope.isInStringRadarChart(col) != 1}' ng-click='grid.appScope.stringRadarChart(col)' style='margin: 0 1px 0 1px;padding:2px 5px 2px 5px;'></button></div>";break;case"num":i.type="num",i.sortingAlgorithm=function(a,b){var c=parseFloat(a.replace(/\s/g,"").replace(",",".")),d=parseFloat(b.replace(/\s/g,"").replace(",","."));return c-d};var k=[];k.condition=function(a,c){return b.filterLessNumberColumns(c,i,h)},i.filterHeaderTemplate="<div class='ui-grid-filter-container' ng-show='!grid.appScope.configurator'>   <button class='btn btn-primary btn-sm btn-flat mdi-image-tune'  style='padding: 4px 6px;' ng-click='grid.appScope.showFilter(col)' data-toggle='modal' data-target='#modalSlider'>   </button>   <button  ng-show='grid.appScope.isFilterOn(col)' class='btn btn-default btn-sm fa fa-close' style='padding:5px' ng-click='grid.appScope.removeFilter(col)'>   </button></div>";var m=[];m.condition=function(a,c){return b.filterGreaterNumberColumns(c,i,h)},i.filters=[],i.filters.push(m),i.filters.push(k),i.footerCellTemplate="<div class='ui-grid-cell-contents'><button class='btn btn-primary fa fa-line-chart btn-sm' ng-class='{\"btn btn-primary btn-sm \" : grid.appScope.isInLineChart(col) == 1, \"btn btn-flat btn-primary btn-sm\": grid.appScope.isInLineChart(col) != 1}' ng-click='grid.appScope.lineChart(col)' style='margin: 0 1px 0 1px;padding:2px 5px 2px 5px;'></button><button class='btn btn-primary fa fa-bar-chart btn-sm' ng-class='{\"btn btn-primary btn-sm \" : grid.appScope.isInBarChart(col) == 1, \"btn btn-flat btn-primary btn-sm\": grid.appScope.isInBarChart(col) != 1}' ng-click='grid.appScope.barChart(col)' style='margin: 0 1px 0 1px;padding:2px 5px 2px 5px;'></button></div>";
break;case"bool":i.type="bool",i.sortingAlgorithm=function(a,b){return"yes"==j.getBooleanValue(a)?1:"no"==j.getBooleanValue(a)?"unknown"==j.getBooleanValue(b)?1:-1:b-a},i.filterHeaderTemplate="<div class='ui-grid-filter-container' ng-show='!grid.appScope.configurator'><button class='btn btn-primary btn-sm' style='padding: 4px 6px;' ng-class='{\"btn btn-primary btn-sm \" : grid.appScope.isFilterOn(col) == 1, \"btn btn-flat btn-primary btn-sm\": grid.appScope.isFilterOn(col) != 1}' ng-click='grid.appScope.applyBooleanFilter(col, 1)' ><i class='mdi-navigation-check'></i></button><button class='btn btn-danger btn-flat' style='padding: 4px 6px;' ng-class='{\"btn btn-danger btn-sm \" : grid.appScope.isFilterOn(col) == 2, \"btn btn-flat btn-danger btn-sm\": grid.appScope.isFilterOn(col) != 2}' btn-xs' ng-click='grid.appScope.applyBooleanFilter(col, 2)' ><i class='mdi-navigation-close'></i></button></div>",i.filter.noTerm=!0,i.filter.condition=function(a,c){return b.filterBooleanColumns(c,h)},i.footerCellTemplate="<div class='ui-grid-cell-contents'><button class='btn btn-primary fa fa-pie-chart btn-sm' ng-class='{\"btn btn-primary btn-sm \" : grid.appScope.isInPieChart(col) == 1, \"btn btn-flat btn-primary btn-sm\": grid.appScope.isInPieChart(col) != 1}' ng-click='grid.appScope.pieChart(col)' style='margin: 0 1px 0 1px;padding:2px 5px 2px 5px;'></button><button class='btn btn-primary fa fa-connectdevelop btn-sm' ng-class='{\"btn btn-primary btn-sm \" : grid.appScope.isInRadarChart(col) == 1, \"btn btn-flat btn-primary btn-sm\": grid.appScope.isInRadarChart(col) != 1}' ng-click='grid.appScope.radarChart(col)' style='margin: 0 1px 0 1px;padding:2px 5px 2px 5px;'></button></div>";break;case"image":i.type="image",i.enableCellEdit="false;",i.cellTemplate='<form><input ng-show="grid.appScope.edit" type="file" ng-model="grid.appScope.file" ng-change="grid.appScope.uploadFile(col, row)" base-sixty-four-input></form><img height="{{grid.appScope.gridOptions.rowHeight}}px"  ng-src="{{grid.getCellValue(row, col)}}" lazy-src>',i.enableFiltering=!1}return i},b.uploadFile=function(a,c){b.file&&b.pcmData.forEach(function(d){d.$$hashKey==c.entity.$$hashKey&&(d[a.name]="data:image/png;base64,"+b.file.base64)})},b.lineChart=function(c){var d=b.gridApi.core.getVisibleRows(b.gridApi.grid);a.$broadcast("lineChart",{col:c,pcmData:d})},b.barChart=function(c){var d=b.gridApi.core.getVisibleRows(b.gridApi.grid);a.$broadcast("barChart",{col:c,pcmData:d})},b.pieChart=function(c){var d=b.gridApi.core.getVisibleRows(b.gridApi.grid);a.$broadcast("pieChart",{col:c,pcmData:d})},b.radarChart=function(c){var d=b.gridApi.core.getVisibleRows(b.gridApi.grid);a.$broadcast("radarChart",{col:c,pcmData:d})},b.stringPieChart=function(c){var d=b.gridApi.core.getVisibleRows(b.gridApi.grid);a.$broadcast("stringPieChart",{col:c,pcmData:d})},b.stringRadarChart=function(c){var d=b.gridApi.core.getVisibleRows(b.gridApi.grid);a.$broadcast("stringRadarChart",{col:c,pcmData:d})},b.isInLineChart=function(a){return n.isInLineChart(a.name)},b.isInBarChart=function(a){return n.isInBarChart(a.name)},b.isInPieChart=function(a){return n.isInPieChart(a.name)},b.isInRadarChart=function(a){return n.isInRadarChart(a.name)},b.isInStringPieChart=function(a){return n.isInStringPieChart(a.name)},b.isInStringRadarChart=function(a){return n.isInStringRadarChart(a.name)},b.initializeEditor=function(c,d,f,g){f&&(c=h.decodePCM(c));var i=h.getConcreteFeatures(c);b.pcmData=c.products.array.map(function(a){var b={};return i.map(function(c){var d=l.convertStringToEditorFormat(c.name);c.name||(d=" ");var e=h.findCell(a,c);b.name=a.name,b[d]=e.content}),b}),b.pcmDataRaw=c.products.array.map(function(a){var b={};return i.map(function(c){var d=l.convertStringToEditorFormat(c.name);c.name||(d=" ");var e=h.findCell(a,c);b.name=a.name,e.rawContent&&""!=e.rawContent?b[d]=e.rawContent:b[d]=e.content}),b}),a.$broadcast("setPcmName",b.pcm.name),b.source="",b.license="","undefined"!=typeof d&&("undefined"!=typeof d.source&&(b.source=d.source),"undefined"!=typeof d.license&&(b.license=d.license)),b.$watch("source",function(){a.$broadcast("modified")}),b.$watch("license",function(){a.$broadcast("modified")}),p(c,d,i,g),q(),b.setGridHeight(),g&&(b.gridOptions.superColDefs=m.sortFeatureGroupByName(b.gridOptions.superColDefs),e(function(){b.loadFeatureGroups(b.gridOptions.columnDefs,b.gridOptions.superColDefs)},0))}}]),angular.module("openCompareEditor").controller("FiltersCtrl",["$rootScope","$scope","$http","$timeout","uiGridConstants","editorUtil","chartService",function(a,b,c,d,e,f,g){function h(a){return"yes"===a.toLowerCase()||"true"===a.toLowerCase()?"yes":"no"===a.toLowerCase()||"false"===a.toLowerCase()?"no":"unknown"}var i;b.columnsFilters=[],b.productFilter="",b.gridOptions2={enableColumnMenus:!1,onRegisterApi:function(a){b.gridApi2=a}},b.slider={options:{range:!0}},b.filterSlider=[],b.removeFilter=function(a){var c=a.colDef.name,d=a.colDef.type;switch(d){case"string":delete b.columnsFilters[c];break;case"num":b.gridOptions.columnDefs.forEach(function(a){a.name==c&&(delete a.filters[0].term,delete a.filters[1].term)}),delete b.columnsFilters[c]}b.gridApi.core.notifyDataChange(e.dataChange.COLUMN)},b.applyBooleanFilter=function(c,d){b.columnsFilters[c.name]==d?b.columnsFilters[c.name]=0:b.columnsFilters[c.name]=d,a.$broadcast("closeCharts",!1),g.initArrays(),b.gridApi.core.notifyDataChange(e.dataChange.COLUMN)},b.applyProductFilter=function(){a.$broadcast("closeCharts",!1),g.initArrays(),b.gridOptions.columnDefs[1].filter.term=b.productFilter},b.isFilterOn=function(a){return b.columnsFilters[a.name]},b.checkFilterSliderMin=function(){b.filterSlider[0]>b.filterSlider[1]&&(b.filterSlider[0]=b.filterSlider[1])},b.checkFilterSliderMax=function(){b.filterSlider[1]<b.filterSlider[0]&&(b.filterSlider[1]=b.filterSlider[0])},b.showFilter=function(a){b.featureToFilter=a.name,b.ListToFilter=[],b.gridOptions2.data=[];var c=a.colDef.type;switch(c){case"string":b.gridApi2.core.notifyDataChange(e.dataChange.COLUMN),b.pcmData.forEach(function(c){-1===b.ListToFilter.indexOf(c[a.name])&&b.ListToFilter.push(c[a.name])}),b.ListToFilter.sort(),d(function(){b.ListToFilter.forEach(function(a){b.gridOptions2.data.push({product:a})})},100),$("#modalStringFilter").modal("show");break;case"num":var g=f.findMinAndMax(b.featureToFilter,b.pcmData);b.slider.options.min=g[0],b.slider.options.max=g[1],b.filterSlider[0]=g[0],b.filterSlider[1]=g[1],g[1]<10?b.slider.options.step=.1:g[1]>1e3?b.slider.options.step=10:b.slider.options.step=1}},b.closeFilter=function(){var c=b.featureToFilter,d=f.convertStringToEditorFormat(c),h="";switch(b.gridOptions.columnDefs.forEach(function(a){a.name==c&&(h=a.type)}),h){case"string":var j=b.gridApi2.selection.getSelectedRows();0==j.length&&b.gridOptions2.data.forEach(function(a){j.push(a)}),b.colFilter=[],b.colFilter.listTerm=[],j.forEach(function(a){b.colFilter.listTerm.push(a.product)}),b.columnsFilters[d]=[],b.columnsFilters[d]=b.colFilter.listTerm,b.gridApi.core.notifyDataChange(e.dataChange.COLUMN);break;case"num":b.gridOptions.columnDefs.forEach(function(a){a.name==d&&(a.filters[0].term=b.filterSlider[0],a.filters[1].term=b.filterSlider[1]+1)}),b.columnsFilters[d]=[]}i&&i.remove(),a.$broadcast("closeCharts",!1),g.initArrays()},b.filterStringColumns=function(a,c){if(b.columnsFilters[c]){for(var d=!1,e=0;!d&&e<b.columnsFilters[c].length;)(a==b.columnsFilters[c][e]||f.isEmptyCell(a))&&(d=!0),e++;return d}return!0},b.filterLessNumberColumns=function(a,c,d){return b.columnsFilters[d]?parseFloat(a.replace(/\s/g,"").replace(",","."))>=c.filters[0].term||f.isEmptyCell(a):!0},b.filterGreaterNumberColumns=function(a,c,d){return b.columnsFilters[d]?parseFloat(a.replace(/\s/g,"").replace(",","."))<=c.filters[1].term||f.isEmptyCell(a):!0},b.filterBooleanColumns=function(a,c){return 1==b.columnsFilters[c]?"yes"==h(a):2==b.columnsFilters[c]?"no"==h(a)||f.isEmptyCell(a):!0},b.$on("updateFilterFromConfigurator",function(a,c){switch(c.type){case"string":c.values.length>0?b.columnsFilters[c.feature]=c.values:delete b.columnsFilters[c.feature];break;case"bool":1==c.values?b.columnsFilters[c.feature]=1:delete b.columnsFilters[c.feature];break;case"num":b.columnsFilters[c.feature]=[],b.gridOptions.columnDefs.forEach(function(a){a.name==c.feature&&(a.filters[0].term=c.values[0],a.filters[1].term=c.values[1])})}b.gridApi.core.notifyDataChange(e.dataChange.COLUMN)})}]),angular.module("openCompareEditor").controller("TypesCtrl",["$rootScope","$scope","$http","$timeout","uiGridConstants","$compile","$modal","typeService",function(a,b,c,d,e,f,g,h){b.featureType="string",b.validation=[],b.validating=!1,b.validate=function(){if(b.validating=!b.validating,b.pcmData.length>0){var c=[],d=0;b.gridOptions.columnDefs.forEach(function(a){" "!=a.name&&"Product"!=a.name&&(b.validation[a.name]=[],c[d]=a.name,d++)}),d=0,b.pcmData.forEach(function(a){for(var e=0;e<c.length;e++){var f=c[e];if(" "!=f){var g="";b.gridOptions.columnDefs.forEach(function(a){a.name==f&&(g=a.type)}),b.validation[f][d]=h.validateType(a[f],g)}}d++})}b.gridApi.core.notifyDataChange(e.dataChange.COLUMN),a.$broadcast("validating")}}]),angular.module("openCompareEditor").controller("ShareCtrl",["$rootScope","$scope","$http","$timeout","uiGridConstants","$compile","$modal",function(a,b,c,d,e,f,g){b.activeShareButton=!1,b.enableEditOption=!1,b.enableExportOption=!1,b.enableTitleOption=!1,b.enableShareOption=!1,b.enableConfiguratorOption=!1,b.enableChartsOption=!1,b.updateShareLinks=function(){b.activeShareButton=!0,b.embedLink='<iframe src="http://'+window.location.hostname+":"+window.location.port+"/embedPCM/"+b.id+"?enableEdit="+b.enableEditOption+"&enableExport="+b.enableExportOption+"&enableTitle="+b.enableTitleOption+"&enableShare="+b.enableShareOption+"&enableShare="+b.enableConfiguratorOption+"&enableShare="+b.enableChartsOption+'" scrolling="no"  width="100%" height="700px" style="border:none;"></iframe>',b.twitterLink="https://twitter.com/intent/tweet?text=%23opencompare&url=http://opencompare.org/pcm/"+b.id,b.facebookLink="https://www.facebook.com/sharer/sharer.php?u=http://opencompare.org/pcm/"+b.id,b.emailLink="mailto:?body=http://opencompare.org/pcm/"+b.id,b.googleLink="https://plus.google.com/share?url=http://opencompare.org/pcm/"+b.id,b.redditLink="http://www.reddit.com/submit?url=http://opencompare.org/pcm/"+b.id},b.updateEmbedLink=function(){b.embedLink='<iframe src="http://'+window.location.hostname+":"+window.location.port+"/embedPCM/"+b.id+"?enableEdit="+b.enableEditOption+"&enableExport="+b.enableExportOption+"&enableTitle="+b.enableTitleOption+"&enableShare="+b.enableShareOption+"&enableShare="+b.enableConfiguratorOption+"&enableShare="+b.enableChartsOption+'" scrolling="no"  width="100%" height="700px" style="border:none;"></iframe>'}}]),angular.module("openCompareEditor").controller("FeatureGroupCtrl",["$rootScope","$scope","$window","$http","$timeout","featureGroupService","editorUtil","$modal",function(a,b,c,d,e,f,g,h){b.edit=!1,b.isAFeature=function(a){return" "!=a.name&&"Product"!=a.name},b.isAFeatureGroup=function(a){return"emptyFeatureGroup"!=a.name},b.setCols=function(){console.log(b.gridOptions);for(var a=b.gridOptions.columnDefs,c=2;c<a.length;c++)b.cols[c-2]={name:a[c].name,isChecked:!1}},b.setFeatureGroupModal=function(a){b.currentFeatureGroup=a,console.log(b.currentFeatureGroup)},b.openAssignFeatureGroupModal=function(a,c){b.cols=c,b.currentFeatureGroup=a,b.$modalInstance=h.open({templateUrl:"/templates/modalAssignFeatureGroup.html",scope:b,controller:"FeatureGroupCtrl"})},b.openRenameFeatureGroupModal=function(a){b.newFeatureGroup=a,b.currentFeatureGroup=a,b.$modalInstance=h.open({templateUrl:"/templates/modalRenameFeatureGroup.html",scope:b,controller:"FeatureGroupCtrl"})},b.deleteUnusedFeatureGroups=function(){var a=0;for(var c in b.gridOptions.superColDefs)b.gridOptions.superColDefs[a]&&(0==g.getNumberOfFeaturesWithThisFeatureGroup(b.gridOptions.columnDefs,b.gridOptions.superColDefs[a].name)&&b.gridOptions.superColDefs.splice(a,1),a++)},b.loadFeatureGroups=function(c,d){var f=b.minWidth,h=$(document).width()-150-30-3;if(h>(c.length-2)*b.minWidth)e(function(){a.$broadcast("reloadFeatureGroup")},100);else for(var i=0;i<d.length;i++){var j=d[i].name,k=jQuery('.ui-grid-header-cell[col-name="'+j+'"]'),l=g.getNumberOfFeaturesWithThisFeatureGroup(c,d[i].name),m=l*f;k.css({"min-width":m+"px","max-width":m+"px","text-align":"center"})}},b.resizeFeatureGroup=function(c,d,f){var h=$(document).width()-150-30-3;if(h>(c.length-2)*b.minWidth)e(function(){a.$broadcast("reloadFeatureGroup")},100);else{var i=jQuery('.ui-grid-header-cell[col-name="'+d.superCol+'"]'),j=i.outerWidth()+f;if(0>f){var k=g.getNumberOfFeaturesWithThisFeatureGroup(c,d.superCol);j<k*d.minWidth&&(j=k*d.minWidth)}i.css({"min-width":j+"px","max-width":j+"px","text-align":"center"})}},b.adaptFeatureGroupsWidthsToHeaderRow=function(a){var b=30/a.length;console.log(b);for(var c=0;c<a.length;c++){var d=a[c].name;if("emptyFeatureGroup"!=d){var e=jQuery('.ui-grid-header-cell[col-name="'+d+'"]'),f=e.outerWidth()-b;e.css({"min-width":f+"px","max-width":f+"px","text-align":"center"})}}},b.getFeaturesWithThisFeatureGroup=function(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];e.superCol==a&&c.push(e.name)}return c},b.isAFeatureWithThisFeatureGroup=function(a,b){return a.superCol==b},b.assignFeatureGroup=function(c,d){b.$modalInstance.close(),a.$broadcast("assignFeatureGroup",{featureGroup:c,features:d})},b.renameFeatureGroup=function(c,d){b.$modalInstance.close(),a.$broadcast("renameFeatureGroup",{oldFeatureGroup:c,newFeatureGroup:d})},b.cancelModal=function(){b.$modalInstance.close()},b.$watch(function(){return c.innerWidth},function(b){a.$broadcast("reloadFeatureGroup")}),b.$on("setGridEdit",function(a,c){b.edit=c[0]})}]),angular.module("openCompareEditor").service("expandeditor",function(){var a=[];this.expandAfterCellEdit=function(b){return{afterCellEditFunctions:a,addFunction:function(){a.push(b)}}};var b=[];this.expandBeginCellEdit=function(a){return{beginCellEditFunctions:b,addFunction:function(){b.push(a)}}};var c=[];this.expandColumnsMoved=function(a){return{columnMovedFunctions:c,addFunction:function(){c.push(a)}}};var d=[];this.expandNavigateFunctions=function(a){return{navigateFunctions:d,addFunction:function(){d.push(a)}}}}),angular.module("openCompareEditor").service("pcmApi",["base64",function(a){var b=Kotlin.modules.pcm.pcm;this.factory=new b.factory.DefaultPcmFactory;var c=this.factory.createJSONLoader(),d=this.factory.createJSONSerializer();this.sortByName=function(a,b){return a.name<b.name?-1:a.name>b.name?1:0},this.createFeature=function(a,b,c){var d=c.createFeature();d.name=a,b.addFeatures(d);for(var e=0;e<b.products.array.length;e++){var f=c.createCell();f.content="",f.feature=d,b.products.array[e].addValues(f)}return d},this.getConcreteFeatures=function(a){function b(a){var c=[];if("undefined"!=typeof a.subFeatures)for(var d=a.subFeatures.array,e=0;e<d.length;e++){var f=d[e];c=c.concat(b(f))}else c.push(a);return c}for(var c=a.features.array,d=[],e=0;e<c.length;e++){var f=c[e];d=d.concat(b(f))}return d},this.findCell=function(a,b){for(var c=a.cells.array,d=0;d<c.length;d++){var e=c[d];if(e.feature.name===b.name)return e}},this.encodePCM=function(a){return this.base64PCMVisitor(a,!0),a},this.decodePCM=function(a){return this.base64PCMVisitor(a,!1),a},this.base64PCMVisitor=function(b,c){function d(b,c){return c?a.encode(b):a.decode(b)}function e(a,b){a.name=d(a.name,b),"undefined"!=typeof a.subFeatures&&a.subFeatures.array.forEach(function(a){e(a,b)})}b.name=d(b.name,c),b.features.array.forEach(function(a){e(a,c)}),b.products.array.forEach(function(a){a.name=d(a.name,c),a.cells.array.forEach(function(a){a.content=d(a.content,c),a.rawContent=d(a.rawContent,c)})})},this.loadPCMModelFromString=function(a){return c.loadModelFromString(a).get(0)},this.serializePCM=function(a){return d.serialize(a)}}]),angular.module("openCompareEditor").service("editorOptions",["$rootScope",function(a){this.initialize=function(b){a.$broadcast("initializeFromExternalSource",b)},this.initializeFromArray=function(b){a.$broadcast("initializeFromArray",b)};var b=!0;this.enableExport=function(a){return{get:b,set:function(){b=a}}};var c=!0;this.enableShare=function(a){return{get:c,set:function(){c=a}}};var d=!0;this.setEdit=function(a){return{get:d,set:function(){d=a}}}}]),angular.module("openCompareEditor").service("sortFeaturesService",function(){function a(a,b){return a.superCol&&b.superCol?"emptyFeatureGroup"==a.superCol?1:"emptyFeatureGroup"==b.superCol?-1:a.superCol<b.superCol?-1:a.superCol>b.superCol?1:0:-1}function b(a,b){return"emptyFeatureGroup"==a.name?1:"emptyFeatureGroup"==b.name?-1:a.name<b.name?-1:a.name>b.name?1:0}this.sortByType=function(a,b){for(var c=[],d=0,e=0,f=0,g=0;g<a.length;g++){var h=a[g];switch(b[h.name]){case"string":c.splice(d,0,h),e++,f++;break;case"number":c.splice(e+1,0,h),f++;break;case"boolean":c.splice(f,0,h)}}return c},this.sortByFeatureGroup=function(b){var c=b.slice(2,b.length);return c.sort(a),c.unshift(b[1]),c.unshift(b[0]),c},this.sortFeatureGroupByName=function(a){return a.sort(b),a}}),angular.module("openCompareEditor").service("featureGroupService",function(){var a="";this.setCurrentFeatureGroup=function(b){a=b},this.getCurrentFeatureGroup=function(){return a}}),angular.module("openCompareEditor").service("editorUtil",["$rootScope",function(a){this.getCellClass=function(a,b){return a&&"bool"==b?-1!=a.toLowerCase().indexOf("yes")||-1!=a.toLowerCase().indexOf("oui")?"yesCell":-1!=a.toLowerCase().indexOf("dunno")||-1==a.toLowerCase().indexOf("no")&&-1==a.toLowerCase().indexOf("non")?!1:"noCell":!1},this.getFeaturesFromArray=function(a){var b=[];return a.forEach(function(a){for(var c in a)-1==b.indexOf(c)&&"$$hashKey"!=c&&b.push(c)}),b},this.getCellTooltip=function(a){if(a){if(-1!=a.toLowerCase().indexOf("<ref")){var b=a.toLowerCase().indexOf("<ref"),c=a.substring(b+11),d=c.replace(/\s/g,"").indexOf('"/>');return c.substring(0,d)}if(-1!=a.toLowerCase().indexOf("<ref>{{")){var b=a.toLowerCase().indexOf("<ref>{{"),c=a.substring(b+11),d=c.replace(/\s/g,"").indexOf("}}</ref>");return c.substring(0,d)}if(-1!=a.toLowerCase().indexOf("<ref>{{")){var b=a.toLowerCase().indexOf("<ref>{{"),c=a.substring(b+11),d=c.replace(/\s/g,"").indexOf("}}</ref>");return c.substring(0,d)}return!1}return!1},this.sortProducts=function(a,b){var c=[];b.sort(function(a,b){return-1==a.position?1:-1==b.position?-1:a.position-b.position});for(var d=0;d<b.length;d++)a.forEach(function(a){b[d].product==a.name&&c.push(a)});return c},this.sortRawProducts=function(a,b){var c=[];return b.forEach(function(b){a.forEach(function(a){a.name==b.name&&c.push(a)})}),c},this.convertStringToEditorFormat=function(a){return a.replace(/\(/g,"%28").replace(/\)/g,"%29")},this.convertStringToPCMFormat=function(a){return a.replace(/%28/g,"(").replace(/%29/g,")")},this.sortFeatures=function(a,b){var c=[];b.sort(function(a,b){return-1==a.position?1:-1==b.position?-1:a.position-b.position});for(var d=0;d<b.length;d++)a.forEach(function(a){var e=b[d].feature.toString().replace(/\(/g,"%28").replace(/\)/g,"%29");""==b[d].feature&&(e=" "),e==a.name&&c.push(a)});return c},this.findMinAndMax=function(a,b){var c=0,d=0;return b.forEach(function(b){parseInt(b[a])>d&&(d=parseFloat(b[a].replace(/\s/g,"").replace(",","."))),parseInt(b[a])<c&&(c=parseFloat(b[a].replace(/\s/g,"").replace(",",".")))}),[c,d]},this.isEmptyCell=function(a){return!a.toLowerCase()||""==a.toLowerCase()||"N/A"==a.toLowerCase()||"?"==a.toLowerCase()||"unknown"==a.toLowerCase()},this.checkIfNameExists=function(a,b){var c="";c=a?a:"New Feature";var d=0;return b.forEach(function(a){var b=a.name.replace(/[0-9]/g,"");b===c&&d++}),0!=d&&(c+=d),c},this.GetUrlValue=function(a){for(var b=document.location.search.substring(1),c=b.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");if(e[0]==a)return e[1]}},this.getNumberOfFeaturesWithThisFeatureGroup=function(a,b){for(var c=0,d=0;d<a.length;d++)a[d].superCol==b&&c++;return c},this.goToCell=function(b,c){a.$broadcast("goToCell",{row:b,col:c})}}]),angular.module("openCompareEditor").service("typeService",["editorUtil",function(a){this.getType=function(b,c){for(var d=0,e=0,f=0,g=0,h=0,i=a.convertStringToEditorFormat(b);c[d];)c[d][i]&&(this.isABase64Image(c[d][i])&&e++,angular.equals(parseInt(c[d][i]),NaN)?this.isBooleanValue(c[d][i])?g++:a.isEmptyCell(c[d][i])||h++:f++),d++;var j="",k=Math.max(e,f,g,h);return j=0==k?"string":e==k?"image":f==k?"num":g==k?"bool":"string"},this.validateType=function(b,c){var d="";return d=angular.equals(parseInt(b),NaN)?this.isBooleanValue(b)?"bool":a.isEmptyCell(b)?"none":"string":"num","none"==d?!0:"string"==c?!0:d===c},this.isBooleanValue=function(a){return"yes"===a.toLowerCase()||"true"===a.toLowerCase()||"no"===a.toLowerCase()||"false"===a.toLowerCase()},this.getBooleanValue=function(a){return"yes"===a.toLowerCase()||"true"===a.toLowerCase()?"yes":"no"===a.toLowerCase()||"false"===a.toLowerCase()?"no":"unknown"},this.isABase64Image=function(a){return-1!=a.indexOf("data:image/png;base64,")}}]),angular.module("openCompareEditor").service("chartService",["editorUtil",function(a){this.initArrays=function(){b=[],c=[],d=[],e=[],f=[],g=[]};var b=[];this.addInLineChart=function(c){c=a.convertStringToPCMFormat(c),b.push(c)},this.removeFromLineChart=function(c){c=a.convertStringToPCMFormat(c);var d=b.indexOf(c);b.splice(d,1)},this.isInLineChart=function(c){c=a.convertStringToPCMFormat(c);var d=b.indexOf(c);return-1!=d};var c=[];this.addInBarChart=function(b){b=a.convertStringToPCMFormat(b),c.push(b)},this.removeFromBarChart=function(b){b=a.convertStringToPCMFormat(b);var d=c.indexOf(b);c.splice(d,1)},this.isInBarChart=function(b){b=a.convertStringToPCMFormat(b);var d=c.indexOf(b);return-1!=d};var d=[];this.addInPieChart=function(b){b=a.convertStringToPCMFormat(b),d.splice(0,1,b)},this.removeFromPieChart=function(b){b=a.convertStringToPCMFormat(b);var c=d.indexOf(b);d.splice(c,1)},this.isInPieChart=function(b){b=a.convertStringToPCMFormat(b);var c=d.indexOf(b);return-1!=c};var e=[];this.addInRadarChart=function(b){b=a.convertStringToPCMFormat(b),e.push(b)},this.removeFromRadarChart=function(b){b=a.convertStringToPCMFormat(b);var c=e.indexOf(b);e.splice(c,1)},this.isInRadarChart=function(b){b=a.convertStringToPCMFormat(b);var c=e.indexOf(b);return-1!=c};var f=[];this.addInStringPieChart=function(b){b=a.convertStringToPCMFormat(b),f.splice(0,1,b)},this.removeFromStringPieChart=function(b){b=a.convertStringToPCMFormat(b);var c=f.indexOf(b);f.splice(c,1)},this.isInStringPieChart=function(b){b=a.convertStringToPCMFormat(b);var c=f.indexOf(b);return-1!=c};var g=[];this.addInStringRadarChart=function(b){b=a.convertStringToPCMFormat(b),g.splice(0,1,b)},this.removeFromStringRadarChart=function(b){b=a.convertStringToPCMFormat(b);var c=g.indexOf(b);g.splice(c,1)},this.isInStringRadarChart=function(b){b=a.convertStringToPCMFormat(b);var c=g.indexOf(b);return-1!=c}}]),angular.module("openCompareEditor").controller("ChartsCtrl",["$rootScope","$scope","chartService","typeService","editorUtil",function(a,b,c,d,e){b.showChartPanel=!1,b.showLineChart=!1,b.showBarChart=!1,b.showPieChart=!1,b.showRadarChart=!1,b.showStringPieChart=!1,b.showStringRadarChart=!1,$("#chartPanel").draggable(),$("#chartPanel").resizable({aspectRatio:4/3,minHeight:600}),$("#chartPanel").on("resize",function(b,c){a.$broadcast("closeCharts")}),b.closeCharts=function(a){a&&(b.showChartPanel=!1),b.showLineChart=!1,b.showBarChart=!1,b.showPieChart=!1,b.showRadarChart=!1,b.showStringPieChart=!1,b.showStringRadarChart=!1,c.initArrays(),b.pieSeries=[],b.radarSeries=[],b.stringPieSeries=[],b.stringRadarSeries=[]},b.$on("closeCharts",function(a,c){b.closeCharts(c)}),b.lineLabels=[],b.lineSeries=[],b.lineData=[],b.$on("lineChart",function(a,d){b.showChartPanel=!0,$("#lineTab").tab("show");var f=e.convertStringToPCMFormat(d.col.name),g=[];if(d.pcmData.forEach(function(a){g.push(a.entity)}),b.showLineChart){var h=b.lineSeries.indexOf(f);if(-1!=h)b.lineSeries.splice(h,1),c.removeFromLineChart(f),b.lineData.splice(h,1),0==b.lineSeries.length&&(b.showLineChart=!1,b.showChartPanel=b.showLineChart||b.showBarChart||b.showPieChart||b.showRadarChart||b.showStringPieChart||b.showStringRadarChart);else{var i=[];g.forEach(function(a){i.push(parseInt(a[f])||0)}),b.lineData.push(i),b.lineSeries.push(f),c.addInLineChart(f)}}else{b.showLineChart=!0,b.lineSeries=[f],c.addInLineChart(f);var i=[],j=[];g.forEach(function(a){j.push(a.name),i.push(parseInt(a[f])||0)}),b.lineData=[i],b.lineLabels=j}}),b.isInLineChart=function(a){var c=e.convertStringToPCMFormat(a.name),d=b.lineSeries.indexOf(c);return-1!=d},b.barLabels=[],b.barSeries=[],b.barData=[],b.$on("barChart",function(a,d){b.showChartPanel=!0,$("#barTab").tab("show");var f=e.convertStringToPCMFormat(d.col.name),g=[];if(d.pcmData.forEach(function(a){g.push(a.entity)}),b.showBarChart){var h=b.barSeries.indexOf(f);if(-1!=h)b.barSeries.splice(h,1),c.removeFromBarChart(f),b.barData.splice(h,1),0==b.barSeries.length&&(b.showBarChart=!1,b.showChartPanel=b.showLineChart||b.showBarChart||b.showPieChart||b.showRadarChart||b.showStringPieChart||b.showStringRadarChart);else{var i=[];g.forEach(function(a){i.push(parseInt(a[f])||0)}),b.barData.push(i),b.barSeries.push(f),c.addInBarChart(f)}}else{b.showBarChart=!0,b.barSeries=[f],c.addInBarChart(f);var i=[],j=[];g.forEach(function(a){j.push(a.name),i.push(parseInt(a[f])||0)}),b.barData=[i],b.barLabels=j}}),b.isInBarChart=function(a){var c=e.convertStringToPCMFormat(a.name),d=b.barSeries.indexOf(c);return-1!=d},b.pieLabels=[],b.pieSeries=[],b.pieData=[],b.$on("pieChart",function(a,f){b.showChartPanel=!0,$("#pieTab").tab("show");var g=e.convertStringToPCMFormat(f.col.name),h=[];if(f.pcmData.forEach(function(a){h.push(a.entity)}),b.colors=["#B2FF59","#FF5722","#DCDCDC"],b.showPieChart){var i=b.pieSeries.indexOf(g);if(-1!=i)b.showPieChart=!1,b.pieSeries=[],c.removeFromPieChart(g),b.showChartPanel=b.showLineChart||b.showBarChart||b.showPieChart||b.showRadarChart||b.showStringPieChart||b.showStringRadarChart;else{var j=[0,0,0];h.forEach(function(a){switch(d.getBooleanValue(a[g])){case"yes":j[0]++;break;case"no":j[1]++;break;case"unknown":j[2]++}}),b.pieData=j,b.pieSeries=[g],c.addInPieChart(g)}}else{b.showPieChart=!0,b.pieSeries=[g],c.addInPieChart(g);var j=[0,0,0],k=["Yes","No","Unknown"];h.forEach(function(a){switch(d.getBooleanValue(a[g])){case"yes":j[0]++;break;case"no":j[1]++;break;case"unknown":j[2]++}}),b.pieData=j,b.pieLabels=k}}),b.isInPieChart=function(a){var c=e.convertStringToPCMFormat(a.name),d=b.pieSeries.indexOf(c);return-1!=d},b.radarLabels=[],b.radarSeries=[],b.radarData=[],b.$on("radarChart",function(a,f){b.showChartPanel=!0,$("#radarTab").tab("show");var g=e.convertStringToPCMFormat(f.col.name),h=[];if(f.pcmData.forEach(function(a){h.push(a.entity)}),b.showRadarChart){var i=b.radarSeries.indexOf(g);if(-1!=i)b.radarSeries.splice(i,1),c.removeFromRadarChart(g),b.radarData.splice(i,1),0==b.radarSeries.length&&(b.showRadarChart=!1,b.showChartPanel=b.showLineChart||b.showBarChart||b.showPieChart||b.showRadarChart||b.showStringPieChart||b.showStringRadarChart);else{var j=[0,0,0];h.forEach(function(a){switch(d.getBooleanValue(a[g])){case"yes":j[0]++;break;case"no":j[1]++;break;case"unknown":j[2]++}}),b.radarData.push(j),b.radarSeries.push(g),c.addInRadarChart(g)}}else{b.showRadarChart=!0,b.radarSeries=[g],c.addInRadarChart(g);var j=[0,0,0],k=["Yes","No","Unknown"];h.forEach(function(a){switch(d.getBooleanValue(a[g])){case"yes":j[0]++;break;case"no":j[1]++;break;case"unknown":j[2]++}}),b.radarData=[j],b.radarLabels=k}}),b.isInRadarChart=function(a){var c=e.convertStringToPCMFormat(a.name),d=b.radarSeries.indexOf(c);return-1!=d},b.stringPieLabels=[],b.stringPieSeries=[],b.stringPieData=[],b.$on("stringPieChart",function(a,d){b.showChartPanel=!0,$("#stringPieTab").tab("show");var f=e.convertStringToPCMFormat(d.col.name),g=[];if(d.pcmData.forEach(function(a){g.push(a.entity)}),b.showStringPieChart){var h=b.stringPieSeries.indexOf(f);if(-1!=h)b.showStringPieChart=!1,b.stringPieSeries=[],c.removeFromStringPieChart(f),b.showChartPanel=b.showLineChart||b.showBarChart||b.showPieChart||b.showRadarChart||b.showStringPieChart||b.showStringRadarChart;else{var i=[],j=[];g.forEach(function(a){var b=a[f],c=j.indexOf(b);-1==c?(j.push(b),i.push(1)):i[c]++}),b.stringPieData=i,b.stringPieLabels=j,b.stringPieSeries=[f],c.addInStringPieChart(f)}}else{b.showStringPieChart=!0,b.stringPieSeries=[f],c.addInStringPieChart(f);var i=[],j=[];g.forEach(function(a){var b=a[f],c=j.indexOf(b);-1==c?(j.push(b),i.push(1)):i[c]++}),b.stringPieData=i,b.stringPieLabels=j}}),b.stringRadarLabels=[],b.stringRadarSeries=[],b.stringRadarData=[],b.$on("stringRadarChart",function(a,d){b.showChartPanel=!0,$("#stringRadarTab").tab("show");var f=e.convertStringToPCMFormat(d.col.name),g=[];if(d.pcmData.forEach(function(a){g.push(a.entity)}),b.showStringRadarChart){var h=b.stringRadarSeries.indexOf(f);if(-1!=h)b.showStringRadarChart=!1,b.stringRadarSeries=[],c.removeFromStringRadarChart(f),b.showChartPanel=b.showLineChart||b.showBarChart||b.showPieChart||b.showRadarChart||b.showStringPieChart||b.showStringRadarChart;else{var i=[],j=[];g.forEach(function(a){var b=a[f],c=j.indexOf(b);-1==c?(j.push(b),i.push(1)):i[c]++}),b.stringRadarData=[i],b.stringRadarLabels=j,b.stringRadarSeries=[f],c.addInStringRadarChart(f)}}else{b.showStringRadarChart=!0,b.stringRadarSeries=[f],c.addInStringRadarChart(f);var i=[],j=[];g.forEach(function(a){var b=a[f],c=j.indexOf(b);-1==c?(j.push(b),i.push(1)):i[c]++}),b.stringRadarData=[i],b.stringRadarLabels=j}}),b.isInStringRadarChart=function(a){var c=e.convertStringToPCMFormat(a.name),d=b.stringRadarSeries.indexOf(c);return-1!=d}}]),angular.module("openCompareEditor").directive("openCompareCharts",function(){return{templateUrl:"/templates/charts.html"}}),angular.module("openCompareEditor").controller("ConfiguratorCtrl",["$rootScope","$scope","editorUtil","typeService",function(a,b,c,d){b.data=[],b.currentPage=0,b.pageSize=5,b.limit={},b.productFilter="",b.booleanFeatures=[],b.stringFeatures=[],b.numberFeatures=[],b.booleanFilteredFeatures=[],b.stringFilteredFeatures=[],b.slider=[],b.conf=!1,b.lineView=!0,b.numberOfPages=function(){return b.length=0,b.data.length>0&&b.data.forEach(function(a){b.isInFilter(a)&&b.length++}),Math.ceil(b.length/b.pageSize)},b.$on("setConfiguratorMode",function(a,c){b.conf=c}),b.$on("setLineView",function(a,c){b.lineView=c}),b.setLineView=function(c){b.lineView=c,a.$broadcast("setLineView",c)},b.$on("initConfigurator",function(a,d){var e=d.features;b.data=d.pcmData,e.forEach(function(a){switch(a.type){case"string":b.stringFeatures.push(a);break;case"bool":b.booleanFeatures.push(a);break;case"num":b.numberFeatures.push(a);var d=c.findMinAndMax(a.name,b.data);b.slider[a.name]={},b.slider[a.name].values=d,b.slider[a.name].options={range:!0,min:d[0],max:d[1],change:function(c,d){b.conf&&b.$emit("updateFilterFromConfigurator",{feature:a.name,type:"num",values:b.slider[a.name].values})}}}})}),b.getUniqueValues=function(a){var c=[];return b.data.forEach(function(b){var d=b[a],e=c.indexOf(d);-1==e&&c.push(d)}),c},b.hasThisFeature=function(a){return"yes"==d.getBooleanValue(a)},b.updateFilterWithThisFeature=function(a,c,d){switch(c){case"bool":b.booleanFilteredFeatures[a]?delete b.booleanFilteredFeatures[a]:b.booleanFilteredFeatures[a]=!0,b.$emit("updateFilterFromConfigurator",{feature:a,type:"bool",values:b.booleanFilteredFeatures[a]});break;case"string":if(b.stringFilteredFeatures[a]){var e=b.stringFilteredFeatures[a].indexOf(d);-1==e?b.stringFilteredFeatures[a].push(d):b.stringFilteredFeatures[a].splice(e,1)}else b.stringFilteredFeatures[a]=[],b.stringFilteredFeatures[a].push(d);b.$emit("updateFilterFromConfigurator",{feature:a,type:"string",values:b.stringFilteredFeatures[a]})}b.currentPage=0},b.isInFilter=function(a){if(b.productFilter&&-1==a.name.indexOf(b.productFilter))return!1;
for(var c in b.booleanFilteredFeatures)if("move"!=c&&"yes"!=d.getBooleanValue(a[c]))return!1;for(var c in b.stringFilteredFeatures)if("move"!=c&&b.stringFilteredFeatures[c].length>0&&-1==b.stringFilteredFeatures[c].indexOf(a[c]))return!1;for(var c in b.slider)if(b.slider[c].values&&(parseFloat(a[c].replace(/\s/g,"").replace(",","."))<b.slider[c].values[0]||parseFloat(a[c].replace(/\s/g,"").replace(",","."))>b.slider[c].values[1]))return!1;return!0},b.collapseAll=function(){b.collapseAll=!0,b.limit["boolean"]=0,b.limit.forEach(function(a){b.limit[a]=0})}}]).filter("startFrom",function(){return function(a,b){return b=+b,a.length>0?a.slice(b):{}}}),angular.module("openCompareEditor").directive("openCompareConfigurator",function(){return{templateUrl:"/templates/configurator.html"}}),angular.module("openCompareEditor").controller("CsvExportController",["$rootScope","$scope","$http","$modal","$modalInstance",function(a,b,c,d,e){b.loading=!1,b.cancel=function(){e.close()},b.title="",b.productAsLines=!0,b.separator=",",b.quote='"',b.valid=function(){b.export_content="",b.loading=!0,c.post("/api/export/csv",{file:JSON.stringify(b.pcmObject),title:b.pcm.title,productAsLines:b.productAsLines,separator:b.separator,quote:b.quote},{responseType:"text/plain",transformResponse:function(a,b){return a}}).success(function(a,c,d,e){b.loading=!1,b.export_content=a}).error(function(a,c,d,e){b.loading=!1,console.log(a)})}}]),angular.module("openCompareEditor").controller("WikitextExportController",["$rootScope","$scope","$http","$modal","$modalInstance",function(a,b,c,d,e){b.loading=!1,b.cancel=function(){e.close()},b.title="",b.export_content="",b.productAsLines=!0,b.valid=function(){b.export_content="",b.loading=!0,c.post("/api/export/wikitext",{file:JSON.stringify(b.pcmObject),productAsLines:b.productAsLines},{responseType:"text/plain",transformResponse:function(a,b){return a}}).success(function(a,c,d,e){b.loading=!1,b.export_content=a}).error(function(a,c,d,e){b.loading=!1,console.log(a)})}}]),angular.module("openCompareEditor").controller("HtmlExportController",["$rootScope","$scope","$http","$modal","$modalInstance",function(a,b,c,d,e){b.loading=!1,b.cancel=function(){e.close()},b.title="",b.productAsLines=!0,b.valid=function(){b.export_content="",b.loading=!0,c.post("/api/export/html",{file:JSON.stringify(b.pcmObject),title:b.pcm.title,productAsLines:b.productAsLines},{responseType:"text/plain",transformResponse:function(a,b){return a}}).success(function(a,c,d,e){b.loading=!1,b.export_content=a}).error(function(a,c,d,e){b.loading=!1,console.log(a)})}}]),angular.module("openCompareEditor").controller("CsvImportController",["$rootScope","$scope","$http","$modalInstance",function(a,b,c,d){b.loading=!1,b.cancel=function(){d.close()},b.file=null,b.title="",b.productAsLines=!0,b.separator=",",b.quote='"',b.valid=function(){var e=new FormData;e.append("file",b.file),e.append("title",b.title),e.append("productAsLines",b.productAsLines),e.append("separator",b.separator),e.append("quote",b.quote),b.loading=!0,c.post("/api/import/csv",e,{transformRequest:angular.identity,headers:{"Content-Type":void 0}}).success(function(c,e,f,g){b.loading=!1;var h=c[0];a.$broadcast("import",h),d.close()}).error(function(a,c,d,e){b.loading=!1,b.message=a})}}]),angular.module("openCompareEditor").controller("WikipediaImportController",["$rootScope","$scope","$http","$modalInstance","base64",function(a,b,c,d,e){b.pcmContainers=[],b.pcmContainerNames=[],b.loading=!1,b.cancel=function(){d.close()},b.url="",b.valid=function(){b.loading=!0,c.post("/api/import/wikipedia",{url:b.url}).success(function(a,c,d,f){b.loading=!1,b.pcmContainers=a,1===a.length?b.selectPCM(0):b.pcmContainers.forEach(function(a,c){b.pcmContainerNames.push({name:e.decode(a.pcm.name),index:c})})}).error(function(a,c,d,e){b.loading=!1,b.message=a})},b.selectPCM=function(c){var e=b.pcmContainers[c];a.$broadcast("import",e),d.close()}}]),angular.module("openCompareEditor").controller("HtmlImportController",["$rootScope","$scope","$http","$modalInstance",function(a,b,c,d){b.loading=!1,b.cancel=function(){d.close()},b.file=null,b.title="",b.productAsLines=!0,b.valid=function(){var a=new FormData,d=new Blob([b.content],{type:"text/html"});a.append("file",d),a.append("title",b.title),a.append("productAsLines",b.productAsLines),b.loading=!0,c.post("/api/import/html",a,{transformRequest:angular.identity,headers:{"Content-Type":void 0}}).success(function(a,c,d,e){b.loading=!1,b.pcmContainers=a,1===a.length?b.selectPCM(0):b.pcmContainers.forEach(function(a,c){b.pcmContainerNames.push({name:base64.decode(a.pcm.name),index:c})})}).error(function(a,c,d,e){b.loading=!1,b.message=a})},b.selectPCM=function(c){var e=b.pcmContainers[c];a.$broadcast("import",e),d.close()}}]),angular.module("openCompareEditor").directive("fileModel",["$parse",function(a){return{restrict:"A",link:function(b,c,d){var e=a(d.fileModel),f=e.assign;c.bind("change",function(){b.$apply(function(){f(b,c[0].files[0])})})}}}]),angular.module("openCompareEditor").controller("CreatorCtrl",["$rootScope","$scope",function(a,b){b.title="",b.rows=1,b.columns=1,b.loading=!1,$(window).load(function(){$("#modalCreator").modal("show")}),b.launchCreation=function(){a.$broadcast("launchCreation",{title:b.title,rows:b.rows,columns:b.columns})}}]),angular.module("openCompareEditor").directive("openCompareCreator",function(){return{templateUrl:"/templates/creator.html"}}),angular.module("openCompareEditor").run(["$templateCache",function(a){a.put("templates/cellTemplate.html",'<div class="ui-grid-cell-contents" title="TOOLTIP"> <div ng-if="grid.appScope.gridOptions.rowHeight <= 40" class="ngCellText" ng-class="col.colIndex()" style="overflow:hidden; text-overflow: ellipsis;white-space: nowrap"> <span ng-cell-text translate="{{COL_FIELD}}" translate-values="{param_1: row.entity.param_1, param_2: row.entity.param_2, param_3: row.entity.param_3, param_4: row.entity.param_4}"> {{COL_FIELD CUSTOM_FILTERS}} </span> </div> <div ng-if="grid.appScope.gridOptions.rowHeight > 40" class="ngCellText" ng-class="col.colIndex()"> <span ng-cell-text translate="{{COL_FIELD}}" translate-values="{param_1: row.entity.param_1, param_2: row.entity.param_2, param_3: row.entity.param_3, param_4: row.entity.param_4}"> {{COL_FIELD CUSTOM_FILTERS}} </span> </div> </div>'),a.put("templates/charts.html",'<div class="panel panel-default" id="chartPanel" ng-class="{&quot;hideBlock&quot; : !showChartPanel, &quot;showBlock&quot; : showChartPanel}" ng-controller="ChartsCtrl"> <div class="panel-heading"> <div class="row"> <div class="col-md-6"> <h3 class="panel-title"><i style="cursor: pointer" class="mdi-action-open-with"></i> Charts</h3> </div> <div class="col-md-1 col-md-offset-5" style="height: 26px"> <button class="btn btn-flat btn-xs" ng-click="closeCharts(true)" style="padding: 0; margin-top:-1px"><i class="mdi-navigation-close"></i></button> </div> </div> </div> <div class="panel-body"> <ul class="nav nav-pills" role="tablist"> <li class="active"><a class="btn-primary" ng-show="showLineChart" id="lineTab" href="#line" role="tab" data-toggle="tab">Line chart (<i class="fa fa-500px"></i>)</a></li> <li><a ng-show="showBarChart" id="barTab" href="#bar" role="tab" data-toggle="tab">Bar chart (<i class="fa fa-500px"></i>)</a></li> <li><a ng-show="showPieChart" id="pieTab" href="#pie" role="tab" data-toggle="tab">Pie chart (<i class="fa fa-check"></i>/<i class="fa fa-times"></i>)</a></li> <li><a ng-show="showRadarChart" id="radarTab" href="#radar" role="tab" data-toggle="tab">Radar chart (<i class="fa fa-check"></i>/<i class="fa fa-times"></i>)</a></li> <li><a ng-show="showStringPieChart" id="stringPieTab" href="#stringPie" role="tab" data-toggle="tab">Pie chart (<i class="fa fa-header"></i>)</a></li> <li><a ng-show="showStringRadarChart" id="stringRadarTab" href="#stringRadar" role="tab" data-toggle="tab">Radar chart (<i class="fa fa-header"></i>)</a></li> </ul> <div class="tab-content"> <div class="tab-pane active" id="line"> <canvas ng-if="showLineChart" id="line" class="chart chart-line" data="lineData" labels="lineLabels" legend="true" series="lineSeries" responsive="true"></canvas> </div> <div class="tab-pane" id="bar"> <canvas ng-if="showBarChart" id="bar" class="chart chart-bar" data="barData" labels="barLabels" series="barSeries" legend="true"></canvas> </div> <div class="tab-pane" id="pie"> <h3 ng-repeat="serie in pieSeries">{{serie}}</h3> <canvas ng-if="showPieChart" id="pie" class="chart chart-pie" data="pieData" labels="pieLabels" legend="true" colours="colors"></canvas> </div> <div class="tab-pane" id="radar"> <h3 ng-repeat="serie in radarSeries">{{serie}}</h3> <canvas ng-if="showRadarChart" id="radar" class="chart chart-radar" data="radarData" labels="radarLabels"></canvas> </div> <div class="tab-pane" id="stringPie"> <h3>{{stringPieSeries[0]}}</h3> <canvas ng-if="showStringPieChart" id="pie" class="chart chart-pie" data="stringPieData" labels="stringPieLabels" legend="true"></canvas> </div> <div class="tab-pane" id="stringRadar"> <h3>{{stringRadarSeries[0]}}</h3> <canvas ng-if="showStringRadarChart" id="radar" class="chart chart-radar" data="stringRadarData" labels="stringRadarLabels"></canvas> </div> </div> </div> </div>'),a.put("templates/configurator.html",'<div class="col-md-3 panel panel-default" style="margin-right: 10px"> <div class="list-group panel-body"> <div class="list-group-item"> <div class="row-action-primary"> </div> <div class="row-content"> <div class="least-content">Search</div> <p class="list-group-item-heading">Product</p> <p class="list-group-item-text"> <input class="form-control floating-label" ng-change="applyProductFilter()" type="text" placeholder="Find" ng-model="productFilter"> </p> </div> </div> <div class="list-group-separator"></div> <div class="list-group-item" ng-if="booleanFeatures.length > 0"> <div class="row-action-primary"> </div> <div class="row-content" ng-init="limit.boolean=5"> <div class="least-content"> <button ng-show="limit.boolean == 0" ng-click="limit.boolean = 5" class="btn btn-flat btn-primary btn-xs"><i class="mdi-navigation-expand-less"></i></button> <button ng-show="limit.boolean != 0" ng-click="limit.boolean = 0" class="btn btn-flat btn-primary btn-xs"><i class="mdi-navigation-expand-more"></i></button> </div> <p class="list-group-item-heading">Features</p> <p class="list-group-item-text"> <div class="checkbox checkbox-primary" ng-repeat="feature in booleanFeatures | limitTo: limit.boolean"> <label> <input type="checkbox" ng-model="booleanFilter" ng-change="updateFilterWithThisFeature(feature.name, feature.type)"> {{feature.displayName}} </label> </div> <button ng-show="booleanFeatures.length > 5 && limit.boolean != booleanFeatures.length && limit.boolean != 0" ng-click="limit.boolean = booleanFeatures.length" class="btn btn-flat btn-primary btn-xs">Show more <i class="mdi-navigation-expand-more"></i></button> <button ng-show="booleanFeatures.length > 5 && limit.boolean == booleanFeatures.length" ng-click="limit.boolean = 5" class="btn btn-flat btn-primary btn-xs">Show less <i class="mdi-navigation-expand-less"></i></button> </p> </div> </div> <div class="list-group-item" ng-if="stringFeatures.length > 0" ng-repeat="feature in stringFeatures"> <div class="row-action-primary"> </div> <div class="row-content"> <div class="least-content"> <button ng-show="limit[feature.displayName] == 0" ng-click="limit[feature.displayName] = 5" class="btn btn-flat btn-primary btn-xs"><i class="mdi-navigation-expand-less"></i></button> <button ng-show="limit[feature.displayName] != 0" ng-click="limit[feature.displayName] = 0" class="btn btn-flat btn-primary btn-xs"><i class="mdi-navigation-expand-more"></i></button> </div> <p class="list-group-item-heading">{{feature.displayName}}</p> <p class="list-group-item-text" ng-init="limit[feature.displayName]=5"> <div class="checkbox checkbox-primary" ng-repeat="value in getUniqueValues(feature.name) | limitTo:limit[feature.displayName]"> <label> <input type="checkbox" ng-model="stringFilter" ng-change="updateFilterWithThisFeature(feature.name, feature.type, value)"> {{value}} </label> </div> <button ng-if="limit[feature.displayName] != 0 && getUniqueValues(feature.name).length > 5 && limit[feature.displayName] != getUniqueValues(feature.name).length" ng-click="limit[feature.displayName] = getUniqueValues(feature.name).length" class="btn btn-flat btn-primary btn-xs">Show more <i class="mdi-navigation-expand-more"></i></button> <button ng-if="getUniqueValues(feature.name).length > 5 &&limit[feature.displayName] == getUniqueValues(feature.name).length" ng-click="limit[feature.displayName] = 5" class="btn btn-flat btn-primary btn-xs">Show less <i class="mdi-navigation-expand-less"></i></button> </p> </div> <div class="list-group-separator"></div> </div> <div class="list-group-separator" ng-if="booleanFeatures.length > 0"></div> <div class="list-group-item" ng-if="numberFeatures.length > 0" ng-repeat="feature in numberFeatures"> <div class="row-action-primary"> </div> <div class="row-content"> <div class="least-content">Number</div> <p class="list-group-item-heading">{{feature.displayName}}</p> <p class="list-group-item-text"> <div ui-slider="slider[feature.name].options" name="{{feature.name}}" ng-model="slider[feature.name].values"></div> <div class="row"> <div class="col-md-3"> <span>{{slider[feature.name].values[0]}}</span> </div> <div class="col-md-3 col-md-offset-6" style="text-align: right"> <span>{{slider[feature.name].values[1]}}</span> </div> </div> </p> </div> <div class="list-group-separator"></div> </div> </div> </div> <div class="col-md-8"> <div class="col-md-1"> <button type="button" ng-show="configurator && !lineView" style="padding: 5px" class="btn btn-flat btn-primary btn-sm" ng-click="setLineView(true)"><i class="mdi-action-view-headline"></i></button> <button type="button" ng-show="configurator && lineView" style="padding: 5px" class="btn btn-flat btn-primary btn-sm" ng-click="setLineView(false)"><i class="mdi-image-grid-on"></i></button> </div> </div> <div class="col-md-8" ng-show="lineView"> <div class="row"> <div class="list-group" ng-init="showProduct = []"> <div class="list-group-item" style="margin:5px" ng-repeat="product in (filteredData = (data | filter:isInFilter | startFrom:currentPage*pageSize | limitTo:pageSize))"> <div class="row-action-primary"> </div> <div class="row-content panel panel-default" ng-init="showProduct[product.name] = true"> <div class="panel-heading"> <div class="least-content"> <button ng-show="!showProduct[product.name]" ng-click="showProduct[product.name] = true" class="btn btn-flat btn-primary btn-xs"><i class="mdi-navigation-expand-less"></i></button> <button ng-show="showProduct[product.name]" ng-click="showProduct[product.name] = false" class="btn btn-flat btn-primary btn-xs"><i class="mdi-navigation-expand-more"></i></button> </div> <h4 class="list-group-item-heading">{{product.name}}</h4> </div> <div class="panel-body" ng-show="showProduct[product.name]"> <p class="list-group-item-text"> <div class="row" ng-repeat="feature in stringFeatures" ng-if="product[feature.name] != \'\'"> <div class="col-md-6"><h5>{{feature.displayName}}</h5></div> <div class="col-md-6"><p>{{product[feature.name]}}</p></div> <div class="list-group-separator"></div> </div> <div class="row" ng-repeat="feature in numberFeatures" ng-if="product[feature.name] != \'\'"> <div class="col-md-6"><h5>{{feature.displayName}}</h5></div> <div class="col-md-6"><p>{{product[feature.name]}}</p></div> <div class="list-group-separator"></div> </div> <div class="row" ng-if="booleanFeatures.length > 0"> <div class="col-md-12"> <div class="col-md-6"><h5>Features</h5></div> <div class="col-md-6"> <span ng-repeat="feature in booleanFeatures" ng-if="product[feature.name] != \'\' && hasThisFeature(product[feature.name])">{{feature.displayName}}, </span> </div> </div> </div> </p> </div> </div> <div class="list-group-separator" ng-if="numberFeatures.length > 0"></div> </div> </div> </div> <div class="row"> <div class="col-md-2 col-md-offset-2"> <select ng-model="pageSize" class="form-control" id="select" name="pageSize"> <option value="5">5 per page</option> <option value="10">10 per page</option> <option value="25">25 per page</option> <option value="50">50 per page</option> <option value="100">100 per page</option> </select> </div> <div class="col-md-4"> <button class="btn btn-primary" ng-disabled="currentPage == 0" ng-click="currentPage=currentPage-1"> Previous </button> {{currentPage+1}}/{{numberOfPages()}} <button class="btn btn-primary" ng-disabled="currentPage >= length/pageSize - 1" ng-click="currentPage=currentPage+1"> Next </button> </div> </div> </div>'),a.put("templates/creator.html",'<div class="modal fade in" id="modalCreator" data-backdrop="static" data-keyboard="false" ng-controller="CreatorCtrl"> <div class="modal-dialog modal-lg"> <div class="modal-content"> <div class="modal-header"> <h4 class="modal-title">Welcome to your table creator</h4> <br> </div> <div class="modal-body"> <form class="form-horizontal"> <div class="form-group" style="margin-bottom: 20px"> <p>Start by giving a title to your table:</p> <div class="col-lg-12"> <input type="text" class="form-control" id="title" placeholder="Title" ng-model="title"> </div> </div> <div class="form-group"> <p>Now choose a size:</p> <label for="rows" class="col-lg-4 control-label">Number of rows:</label> <div class="col-lg-8"> <input type="number" class="form-control" id="rows" placeholder="Rows" ng-model="rows"> </div> <br> <label for="columns" class="col-lg-4 control-label">Number of columns:</label> <div class="col-lg-8"> <input type="number" class="form-control" id="columns" placeholder="Columns" ng-model="columns"> </div> </div> </form> </div> <div class="modal-footer"> <a type="button" class="btn btn-default" href="/">{{ "edit.button.cancel" | translate }}</a> <button data-dismiss="modal" aria-hidden="true" type="button" class="btn btn-primary" ng-click="launchCreation()"> Launch creation </button> </div> </div> </div> </div>'),a.put("templates/featureGroupHeader.html",'<div class="ui-grid-header custom-ui-grid-header"> <div class="ui-grid-top-panel"> <div class="ui-grid-header-viewport"> <div class="ui-grid-header-canvas"> <div class="ui-grid-header-cell-wrapper" style="display: block" ng-style="colContainer.headerCellWrapperStyle()"> <div class="ui-grid-header-cell-row" ng-show="grid.options.superColDefs.length != 0" ng-if="colContainer.name === \'body\'" style="display:block;border-left:  1px solid #d4d4d4;height:30px"> <div class="ui-grid-header-cell" ng-repeat="superCol in grid.options.superColDefs track by $index" col-name="{{superCol.name}}"> <div class="ui-grid-cell-contents" ng-bind="superCol.displayName"> </div> <div class="ui-grid-column-menu-button" ng-show="superCol.name != \'emptyFeatureGroup\'"> <a class="dropdown-toggle" data-toggle="dropdown" data-target="#" style="cursor:pointer;color:#515151"> <i class="ui-grid-icon-angle-down"></i> </a> <ul class="dropdown-menu" ng-controller="FeatureGroupCtrl" style="left: -140px"> <li><a href="#" ng-click="openRenameFeatureGroupModal(superCol.name)"><i class="fa fa-pencil"></i> Rename</a></li> <li><a href="#" ng-click="grid.appScope.deleteFeatureGroup(superCol.name)"><i class="fa fa-trash"></i> Remove</a></li> <li><a href="#" ng-click="openAssignFeatureGroupModal(superCol.name, grid.options.columnDefs)"><i class="fa fa-link"></i> Assign</a></li> </ul> </div> </div> </div> <div class="ui-grid-header-cell-row" ng-show="grid.options.superColDefs.length != 0" ng-if="colContainer.name !== \'body\'" style="display: block;height:30px"> <br> </div> <div class="ui-grid-header-cell-row"> <div class="ui-grid-header-cell ui-grid-clearfix" ng-repeat="col in colContainer.renderedColumns track by col.colDef.name" ui-grid-header-cell col="col" super-col-width-update render-index="$index"> </div> </div> </div> </div> </div> </div> </div>'),a.put("templates/modalAssignFeatureGroup.html",'<div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="cancelModal()"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">{{ "edit.title.assignFeatureGroup" | translate }}</h4> </div> <div class="modal-body" ng-init="checkbox = []"> <h4>{{currentFeatureGroup}} </h4> <label for="featureName">Features :</label> <div class="checkbox checkbox-primary" name="featuresSelection" ng-repeat="col in cols | filter:isAFeature" ng-init="checkbox[col.name] = isAFeatureWithThisFeatureGroup(col, currentFeatureGroup)"> <label> <input type="checkbox" ng-model="checkbox[col.name]"> {{ col.name }} </label> </div> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="cancelModal()">{{ "edit.button.cancel" | translate }}</button> <button type="button" class="btn btn-success" data-dismiss="modal" ng-click="assignFeatureGroup(currentFeatureGroup, checkbox)">{{ "edit.button.apply" | translate }}</button> </div>'),a.put("templates/modalCreateFeatureGroup.html",'<div class="modal-header" id="createFeatureGroupModal"> <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="cancelModal()"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">{{ "edit.title.createNewFeatureGroup" | translate }}</h4> </div> <div class="modal-body" ng-init="checkbox = []"> <label for="featureName">{{ "edit.title.featureName" | translate }}: </label> <input ng-model="featureName" type="text" id="featureName"> <br> <label for="featuresSelection">{{ "edit.title.featureSelection" | translate }}: </label> <div class="checkbox checkbox-primary" name="featuresSelection" ng-repeat="col in gridOptions.columnDefs | filter:isAFeature" ng-init="checkbox[col.name] = false"> <label> <input type="checkbox" ng-model="checkbox[col.name]"> {{ col.name }} </label> </div> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="cancelModal()">{{ "edit.button.cancel" | translate }}</button> <button type="button" class="btn btn-success" ng-click="addFeatureGroup(featureName, checkbox);">{{ "edit.button.apply" | translate }}</button> </div>'),a.put("templates/modalCsvExport.html",'<div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="cancel()"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">Export a PCM to CSV</h4> </div> <div class="modal-body"> <form name="importPcm" id="import_pcm" class="form-horizontal" method="post" enctype="multipart/form-data"> <div class="form-group"> <label class="col-md-4 control-label">Product in lines ?</label> <div class="col-md-8"> <input ng-model="productAsLines" type="checkbox" id="productAsLines" size="3"> </div> </div> <div class="form-group"> <label class="col-md-4 control-label">Separator</label> <div class="col-md-1"> <input ng-model="separator" type="text" id="separator" size="3" required> </div> </div> <div class="form-group"> <label class="col-md-4 control-label">Quote</label> <div class="col-md-1"> <input ng-model="quote" type="text" id="quote" size="3"> </div> </div> </form> <div ng-show="export_content"> <hr> <textarea ng-model="export_content" rows="25" style="min-width: 100%"></textarea> </div> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="cancel()">Cancel</button> <button type="submit" class="btn btn-success" form="import_pcm" ng-click="valid()"> <i ng-show="loading" class="fa fa-spinner fa-pulse"></i> <div ng-hide="loading"> <span ng-hide="export_message">Export</span> <span ng-show="export_message">Reload</span> </div> </button> </div>'),a.put("templates/modalCsvImport.html",'<div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="cancel()"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">Import a PCM from CSV</h4> </div> <div class="modal-body"> <div ng-model="message" style="color:orangered"></div> <form name="importPcm" id="import_pcm" class="form-horizontal" method="post" enctype="multipart/form-data"> <div class="form-group"> <label class="col-md-4 control-label">Csv file</label> <div class="col-md-8"> <input type="file" id="file" required file-model="file"> </div> </div> <div class="form-group"> <label class="col-md-4 control-label">Title</label> <div class="col-md-8"> <input ng-model="title" class="form-control" type="string" id="title" required> </div> </div> <div class="form-group"> <label class="col-md-4 control-label">Product in lines ?</label> <div class="col-md-8"> <input ng-model="productAsLines" type="checkbox" id="productAsLines" size="3"> </div> </div> <div class="form-group"> <label class="col-md-4 control-label">Separator</label> <div class="col-md-1"> <input ng-model="separator" type="text" id="separator" size="3" required> </div> </div> <div class="form-group"> <label class="col-md-4 control-label">Quote</label> <div class="col-md-1"> <input ng-model="quote" type="text" id="quote" size="3"> </div> </div> </form> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="cancel()">Cancel</button> <button type="submit" class="btn btn-success" form="import_pcm" ng-click="valid()"> <i ng-show="loading" class="fa fa-spinner fa-pulse"></i> <span ng-show="!loading">Import</span> </button> </div>'),a.put("templates/modalHtmlExport.html",'<div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="cancel()"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">Export a PCM to HTML</h4> </div> <div class="modal-body"> <form name="importPcm" id="import_pcm" class="form-horizontal" method="post" enctype="multipart/form-data"> <div class="form-group"> <label class="col-md-4 control-label">Product in lines ?</label> <div class="col-md-8"> <input ng-model="productAsLines" type="checkbox" id="productAsLines" size="3"> </div> </div> </form> <div ng-hide="!export_content"> <hr> <textarea ng-model="export_content" rows="25" style="min-width: 100%"></textarea> </div> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="cancel()">Cancel</button> <button type="submit" class="btn btn-success" form="import_pcm" ng-click="valid()"> <i ng-show="loading" class="fa fa-spinner fa-pulse"></i> <div ng-hide="loading"> <span ng-hide="export_message">Export</span> <span ng-show="export_message">Reload</span> </div> </button> </div>'),a.put("templates/modalHtmlImport.html",'<div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="cancel()"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">Import a PCM from HTML</h4> </div> <div class="modal-body"> <div ng-model="message" style="color:orangered"></div> <form name="importPcm" id="import_pcm" class="form-horizontal" method="post"> <div class="form-group"> <label class="col-md-4 control-label">Title</label> <div class="col-md-8"> <input ng-model="title" class="form-control" type="string" id="title" required> </div> </div> <div class="form-group"> <label class="col-md-4 control-label">Product in lines ?</label> <div class="col-md-8"> <input ng-model="productAsLines" type="checkbox" id="productAsLines" size="3"> </div> </div> <div class="form-group"> <label class="col-md-4 control-label">Copy paste your code</label> <div> <textarea ng-model="content" rows="25" id="content" style="min-width: 100%"></textarea> </div> </div> </form> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="cancel()">Cancel</button> <button type="submit" class="btn btn-success" form="import_pcm" ng-click="valid()"> <i ng-show="loading" class="fa fa-spinner fa-pulse"></i> <span ng-show="!loading">Import</span> </button> </div>'),a.put("templates/modalRenameFeatureGroup.html",'<div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="cancelModal()"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">{{ "edit.title.renameFeature" | translate }}</h4> </div> <div class="modal-body"> <label for="featureName">Feature name: </label> <input ng-model="newFeatureGroup" type="text" id="featureName" value="{{newFeatureGroup}}"> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="cancelModal()">{{ "edit.button.cancel" | translate }}</button> <button type="button" class="btn btn-success" data-dismiss="modal" ng-click="renameFeatureGroup(currentFeatureGroup, newFeatureGroup)">{{ "edit.button.apply" | translate }}</button> </div>'),a.put("templates/modalWikipediaImport.html",'<div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="cancel()"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">Import a PCM from Wikipedia</h4> </div> <div class="modal-body"> <div ng-model="message" style="color:orangered"></div> <form name="importPcm" id="import_pcm" class="form-horizontal" method="post"> <div class="form-group"> <label class="col-md-3 control-label">Page URL</label> <div class="col-md-9"> <input ng-model="url" class="form-control" type="text" name="url" id="url" required> </div> </div> </form> <div ng-if="pcmContainers.length > 0"> <form class="form"> <div class="form-group"> <label class="control-label">Please select a matrix to edit</label> <ul class="list-group"> <button ng-repeat="pcmContainerName in pcmContainerNames" type="button" class="btn btn-primary btn-flat btn-xs list-group-item" ng-click="selectPCM(pcmContainerName.index)"> {{pcmContainerName.name}} </button> </ul> </div> </form> </div> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="cancel()">Cancel</button> <button type="submit" class="btn btn-success" form="import_pcm" ng-click="valid()"> <i ng-show="loading" class="fa fa-spinner fa-pulse"></i> <span ng-show="!loading">Import</span> </button> </div>'),a.put("templates/modalWikitextExport.html",'<div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="cancel()"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">Export a PCM to Wikipedia</h4> </div> <div class="modal-body"> <form name="importPcm" id="import_pcm" class="form-horizontal" method="post" enctype="multipart/form-data"> <div class="form-group"> <label class="col-md-4 control-label">Product in lines ?</label> <div class="col-md-8"> <input ng-model="productAsLines" type="checkbox" id="productAsLines" size="3"> </div> </div> </form> <div ng-hide="!export_content"> <hr> <textarea ng-model="export_content" rows="25" style="min-width: 100%"></textarea> </div> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="cancel()">Cancel</button> <button type="submit" class="btn btn-success" form="import_pcm" ng-click="valid()"> <i ng-show="loading" class="fa fa-spinner fa-pulse"></i> <div ng-hide="loading"> <span ng-hide="export_message">Export</span> <span ng-show="export_message">Reload</span> </div> </button> </div>'),a.put("templates/pcmEditor.html",'<div id="editor" ng-controller="EditorCtrl"> <div class="modal fade" id="modalRemove" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">{{ "edit.button.confirm" | translate }}</h4> </div> <div class="modal-body"> {{ "edit.warning.removeIsDefinitive" | translate }} </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">{{ "edit.button.cancel" | translate }}</button> <button type="button" class="btn btn-danger" data-dismiss="modal" ng-click="remove()">{{ "edit.button.apply" | translate }}</button> </div> </div> </div> </div> <div class="modal fade" id="modalCancel" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">{{ "edit.title.confirm" | translate }}</h4> </div> <div class="modal-body"> {{ "edit.warning.cancelWillLoseChanges" | translate }} </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">{{ "edit.button.no" | translate }}</button> <button type="button" class="btn btn-success" data-dismiss="modal" ng-click="setEdit(false, true)">{{ "edit.button.yes" | translate }}</button> </div> </div> </div> </div> <div class="modal fade" id="modalNewFeature" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"> <div class="modal-dialog modal-lg"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">{{ "edit.title.createNewFeature" | translate }}</h4> </div> <div class="modal-body"> <label for="featureName">{{ "edit.title.featureName" | translate }}: </label> <input ng-model="featureName" type="text" id="featureName"> <label for="featureType">{{ "edit.title.featureType" | translate }}: </label> <select ng-model="featureType" name="featureType"> <option value="string" selected>{{ "edit.type.string" | translate }}</option> <option value="num">{{ "edit.type.number" | translate }}</option> <option value="bool">{{ "edit.type.boolean" | translate }}</option> <!--<option value="image">Image</option>--> </select> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">{{ "edit.button.cancel" | translate }}</button> <button type="button" class="btn btn-success" data-dismiss="modal" ng-click="addFeature()">{{ "edit.button.apply" | translate }}</button> </div> </div> </div> </div> <div class="modal fade" id="modalRenameFeature" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">{{ "edit.title.renameFeature" | translate }}</h4> </div> <div class="modal-body"> <label for="featureName">Feature name: </label> <input ng-model="featureName" type="text" id="featureName" value="{featureName}"> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">{{ "edit.button.cancel" | translate }}</button> <button type="button" class="btn btn-success" data-dismiss="modal" ng-click="renameFeature()">{{ "edit.button.apply" | translate }}</button> </div> </div> </div> </div> <div class="modal fade" id="modalChangeType" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">{{ "edit.title.renameFeature" | translate }}</h4> </div> <div class="modal-body"> <label for="featureType">{{ "edit.title.featureType" | translate }}: </label> <select ng-model="featureType"> <option value="string">{{ "edit.type.string" | translate }}</option> <option value="num">{{ "edit.type.number" | translate }}</option> <option value="bool">{{ "edit.type.boolean" | translate }}</option> </select> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">{{ "edit.button.cancel" | translate }}</button> <button type="button" class="btn btn-success" data-dismiss="modal" ng-click="changeType()">{{ "edit.button.apply" | translate }}</button> </div> </div> </div> </div> <div class="modal fade" id="modalSlider" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <span class="help-block">{{ "edit.title.selectRange" | translate }}</span> </div> <div class="modal-body"> <div ui-slider="slider.options" ng-model="filterSlider"></div> <div class="btn-group"> <button class="btn btn-primary btn-raised btn-sm">{{ "edit.title.from" | translate }} :</button> <input type="number" class="btn btn-default btn-raised btn-sm" ng-blur="checkFilterSliderMin()" ng-model="filterSlider[0]"> <button class="btn btn-primary btn-raised btn-sm">{{ "edit.title.to" | translate }} :</button> <input type="number" class="btn btn-default btn-raised btn-sm" ng-blur="checkFilterSliderMax()" ng-model="filterSlider[1]"> </div> <p></p> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">{{ "edit.button.cancel" | translate }}</button> <button type="button" class="btn btn-primary btn-raised btn-sm" data-dismiss="modal" ng-click="closeFilter()">{{ "edit.button.apply" | translate }}</button> </div> </div> </div> </div> <div class="modal fade" id="modalStringFilter" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <span class="help-block">{{ "edit.title.selectProducts" | translate }} :</span> </div> <div class="modal-body"> <div id="grid2" ui-grid="gridOptions2" ui-grid-selection ui-grid-resize-columns ui-grid-auto-resize></div> </div> <div class="modal-footer"> <button type="button" class="btn btn-default btn-sm" data-dismiss="modal">{{ "edit.button.cancel" | translate }}</button> <button type="button" class="btn btn-primary btn-raised btn-sm" data-dismiss="modal" ng-click="closeFilter()">{{ "edit.button.apply" | translate }}</button> </div> </div> </div> </div> <div class="modal fade" id="modalShare" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel">{{ "edit.title.embed" | translate }}</h4> </div> <div class="modal-body"> <label for="options">Options: </label><br> <input type="checkbox" name="title" value="enableTitle" ng-model="enableTitleOption" ng-change="updateEmbedLink()"> {{ "edit.title.showTitle" | translate }}<br> <input type="checkbox" name="edit" value="enableEdit" ng-model="enableEditOption" ng-change="updateEmbedLink()"> {{ "edit.title.allowEdition" | translate }}<br> <input type="checkbox" name="export" value="enableExport" ng-model="enableExportOption" ng-change="updateEmbedLink()"> {{ "edit.title.allowExportation" | translate }}<br> <input type="checkbox" name="share" value="enableShare" ng-model="enableShareOption" ng-change="updateEmbedLink()"> {{ "edit.title.allowSharing" | translate }}<br> <input type="checkbox" name="share" value="enableConfigurator" ng-model="enableConfiguratorOption" ng-change="updateEmbedLink()"> {{ "edit.title.allowConfigurator" | translate }}<br> <input type="checkbox" name="share" value="enableCharts" ng-model="enableChartsOption" ng-change="updateEmbedLink()"> {{ "edit.title.allowCharts" | translate }}<br> <br> <label for="code">Code: </label> <textarea id="code" rows="4" cols="60" ng-model="embedLink">\n\n                    </textarea> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">{{ "edit.button.cancel" | translate }}</button> </div> </div> </div> </div> <!-- Table editor --> <open-compare-toolbar ng-controller="ToolbarCtrl"></open-compare-toolbar> <div class="container-fluid"> <div class="row"> <open-compare-configurator style="margin-top:20px" ng-controller="ConfiguratorCtrl" ng-show="conf"></open-compare-configurator> <div ng-show="!configurator || (configurator && !lineView)" id="matrix" class="grid" ng-class="{\'col-md-8\': configurator, \'col-md-12\': !configurator}" ui-grid="gridOptions" ng-style="{\'height\' : height}" ui-grid-selection ui-grid-edit ui-grid-cellnav ui-grid-resize-columns ui-grid-move-columns ui-grid-auto-resize ui-grid-pinning> <div class="grid-overlay-msg" ng-hide="gridOptions.data.length && !loading"> <div class="msg"> <span class="loader"> Loading Data...</span> </div> </div> </div> <div> <div ng-show="!edit"> <p ng-if="source"><strong>Source:</strong> {{source}}</p> <p ng-if="license"><strong>License:</strong> {{license}}</p> </div> <form class="form-horizontal" ng-show="edit"> <fieldset> <div class="form-group col-lg-5"> <label for="pcm-source" class="control-label">{{ "edit.source.placeholder" | translate }}:</label> <input id="pcm-source" class="form-control" type="text" ng-model="source" placeholder="{{ &quot;edit.source.placeholder&quot; | translate }}"> </div> <div class="form-group col-lg-5"> <label for="pcm-license" class="control-label">{{ "edit.license.placeholder" | translate }}:</label> <input id="pcm-license" class="form-control" type="text" ng-model="license" placeholder="{{ &quot;edit.license.placeholder&quot; | translate }}"> </div> </fieldset> </form> </div> </div> </div> </div> '),
a.put("templates/toolCellTemplate.html",'<div class="buttonsCell" ng-show="grid.appScope.edit"> <button role="button" class="btn btn-flat btn-default" ng-click="grid.appScope.removeProduct(row)"><i class="fa fa-times"></i></button> </div>'),a.put("templates/toolbar.html",'<div class="row"> <div class="col-xs-12" ng-show="enableTitle"> <h3 ng-show="!edit">{{pcm.name}} </h3> <form class="form-horizontal" ng-show="edit"> <fieldset> <div class="form-group col-lg-5"> <label for="pcm-name" class="control-label">{{ "edit.title.placeholder" | translate }}:</label> <input id="pcm-name" class="form-control" type="text" ng-model="pcm.name" placeholder="{{ &quot;edit.title.placeholder&quot; | translate }}"> </div> </fieldset> </form> </div> </div> <div class="row" ng-show="enableExport || enableEdit"> <div class="col-xs-12"> <a ng-show="!launchFromCreator && !saved && edit" role="button" class="btn btn-default btn-flat btn-raised btn-sm" data-toggle="modal" data-target="#modalCancel"><i class="mdi-navigation-arrow-back"></i> {{ \'edit.button.cancel\' | translate }}</a> <a ng-show="!launchFromCreator && saved && edit" role="button" class="btn btn-default btn-flat btn-raised btn-sm" onclick="window.location.href=window.location.href"><i class="mdi-navigation-arrow-back"></i> {{ \'edit.button.cancel\' | translate }}</a> <a ng-show="launchFromCreator && saved && edit" role="button" class="btn btn-default btn-flat btn-raised btn-sm" href="/pcm/{{id}}"><i class="mdi-navigation-arrow-back"></i> {{ \'edit.button.cancel\' | translate }}</a> <a role="button" ng-show="enableEdit && !edit && !configurator" class="btn btn-default btn-flat btn-raised btn-sm" ng-click="setEdit(true, true)"><i class="mdi-editor-mode-edit"></i> {{ \'edit.button.edit\' | translate }}</a> <a role="button" ng-show="!edit && !configurator" class="btn btn-default btn-flat btn-raised btn-sm" ng-click="setConfigurator(true)"><i class="mdi-action-swap-horiz"></i> Configurator</a> <a role="button" ng-show="!edit && configurator" class="btn btn-default btn-flat btn-raised btn-sm" ng-click="setConfigurator(false)"><i class="mdi-action-swap-horiz"></i> Classic</a> <div class="btn-group"> <div class="btn-group" ng-show="enableExport"> <a class="btn btn-default btn-flat dropdown-toggle btn-sm" data-toggle="dropdown"><i class="mdi-action-get-app"></i> {{ \'edit.button.export\' | translate }} <span class="caret"></span></a> <ul class="dropdown-menu"> <li><a href="#" ng-click="export(\'csv\')" data-toggle="modal" data-target="#modalExport"><i class="fa fa-file-excel-o"></i> CSV</a></li> <li><a href="#" ng-click="export(\'wikitext\')" data-toggle="modal" data-target="#modalExport"><i class="fa fa-file-code-o"></i> Wikipedia</a></li> <li><a href="#" ng-click="export(\'html\')" data-toggle="modal" data-target="#modalExport"><i class="fa fa-file-code-o"></i> Html</a></li> </ul> </div> <div class="btn-group" ng-show="enableShare"> <a class="btn dropdown-toggle btn-flat btn-sm" ng-disabled="!activeShareButton" data-toggle="dropdown" ng-click="updateShareLinks()"><i class="mdi-social-share"></i> {{ \'edit.button.share\' | translate }} <span class="caret"></span></a> <ul class="dropdown-menu"> <li><a href="#" data-toggle="modal" data-target="#modalShare"><i class="fa fa-share"></i> {{ \'edit.button.embed\' | translate }}</a></li> <li><a href="{{ emailLink }}"><i class="fa fa-envelope-o"></i> Email</a></li> <li><a href="{{ twitterLink }}" target="_blank"><i class="fa fa-twitter"></i> Twitter</a></li> <li><a href="{{ facebookLink }}" target="_blank"><i class="fa fa-facebook"></i> Facebook</a></li> <li><a href="{{ googleLink }}" target="_blank"><i class="fa fa-google-plus"></i> Google+</a></li> <li><a href="{{ redditLink }}" target="_blank"><i class="fa fa-reddit"></i> Reddit</a></li> </ul> </div> <div class="btn-group" ng-show="!edit && !(configurator && lineView)"> <a class="btn dropdown-toggle btn-flat btn-sm" data-toggle="dropdown"><i class="mdi-navigation-unfold-more"></i> {{ \'edit.button.height\' | translate }} <span class="caret"></span></a> <ul class="dropdown-menu"> <li><a role="button" class="btn btn-flat btn-sm" ng-click="increaseHeight(1)">x 1</a></li> <li><a role="button" class="btn btn-flat btn-sm" ng-click="increaseHeight(2)">x 2</a></li> <li><a role="button" class="btn btn-flat btn-sm" ng-click="increaseHeight(4)">x 4</a></li> <li><a role="button" class="btn btn-flat btn-sm" ng-click="increaseHeight(8)">x 8</a></li> </ul> </div> </div> <div class="btn-group"> <a ng-show="edit" role="button" class="btn btn-default btn-sm" ng-class="{&quot;btn btn-flat btn-default &quot; : !saved, &quot;btn btn-success&quot;: saved && isTitleSet}" ng-disabled="!isTitleSet" ng-click="save()"><i class="fa" ng-class="{&quot;mdi-content-save&quot;: !saved, &quot;mdi-navigation-check&quot;: saved && isTitleSet}"></i> {{ \'edit.button.save\' | translate }}</a> <a ng-show="isInDatabase && edit" type="button" class="btn btn-danger btn-sm" data-toggle="modal" data-target="#modalRemove"><i class="mdi-action-delete"></i> {{ \'edit.button.remove\' | translate }}</a> <a ng-show="edit" role="button" class="btn btn-flat btn-warning btn-sm" ng-class="{&quot;btn btn-warning&quot;: validating, &quot;btn btn-default&quot;: !validating}" ng-click="validate()"><i class="fa" ng-class="{&quot;mdi-action-search&quot;: !validating, &quot;mdi-content-clear&quot;: validating}"></i> {{ \'edit.button.validate\' | translate }}</a> </div> <div class="btn-group"> <a ng-show="edit" role="button" class="btn btn-flat btn-primary btn-sm" data-toggle="modal" data-target="#modalNewFeature"><i class="mdi-content-add"></i> {{ \'edit.button.addfeature\' | translate }}</a> <a ng-show="edit" role="button" class="btn btn-flat btn-primary btn-sm" ng-click="openCreateFeatureGroupModal()"><i class="mdi-content-add-box"></i> {{ \'edit.button.addfeaturegroup\' | translate }}</a> <a ng-show="edit" role="button" class="btn btn-flat btn-primary btn-sm" ng-click="addProduct()"><i class="mdi-content-add"></i> {{ \'edit.button.addproduct\' | translate }}</a> <a ng-show="edit" role="button" class="btn btn-flat btn-default btn-sm" ng-click="undo()" ng-disabled="!canUndo"><i class="mdi-content-undo"></i></a> <a ng-show="edit" role="button" class="btn btn-flat btn-default btn-sm" ng-click="redo()" ng-disabled="!canRedo"><i class="mdi-content-redo"></i></a> </div> </div> </div>')}]);